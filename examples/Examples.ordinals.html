<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Examples.ordinals</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Arith</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Eqdep_dec</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Peano_dec</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Recdef</span>.<br/>

<br/>
</div>

<div class="doc">
  Arithmétique

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;Sur&nbsp;la&nbsp;soustraction&nbsp;(entière)&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">minus_Sn_n</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="var">minus</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">n</span>) = (<span class="id" title="var">S</span> 0).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_S_r</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>) → <span class="id" title="tactic">∃</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">n2</span> = (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">n2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.nlt_0_r</span> <span class="id" title="var">n1</span>). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">n2</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">minus_lt_S</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>) → <span class="id" title="tactic">∃</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="var">minus</span> <span class="id" title="var">n2</span> <span class="id" title="var">n1</span>) = (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">elim</span> (<span class="id" title="var">lt_S_r</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">∃</span> (<span class="id" title="var">minus</span> <span class="id" title="var">n</span> <span class="id" title="var">n1</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_succ_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">le_S_n</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Sur&nbsp;l'ordre&nbsp;strict&nbsp;'lt'&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_1_0</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="var">lt</span> <span class="id" title="var">n</span> 1) → (<span class="id" title="var">n</span>=0).<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.nle_succ_0</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)). <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_S_case</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">m</span> <span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="var">lt</span> <span class="id" title="var">m</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → (<span class="id" title="var">lt</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>) ∨ (<span class="id" title="var">m</span>=<span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">m</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">lt_1_0</span> <span class="id" title="var">m0</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">IHn</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span>:=<span class="id" title="var">m0</span>); <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_lt_Sn_n</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">not</span> (<span class="id" title="var">lt</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Sur&nbsp;l'ordre&nbsp;large&nbsp;'le'&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_le_Sn_n</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">not</span> (<span class="id" title="var">le</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">n</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Cas&nbsp;sur&nbsp;les&nbsp;entiers&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_compare_case</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">n1</span> <span class="id" title="var">n2</span>) ∨ (<span class="id" title="var">n1</span>=<span class="id" title="var">n2</span>) ∨ (<span class="id" title="var">lt</span> <span class="id" title="var">n2</span> <span class="id" title="var">n1</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">left</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> (<span class="id" title="var">IHn1</span> <span class="id" title="var">n2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">left</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">right</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Sur les listes

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;Sur&nbsp;la&nbsp;longueur.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">length_0_nil</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w</span>)=0 → <span class="id" title="var">w</span>=<span class="id" title="var">nil</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">length_Sn_cons</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w</span>)=(<span class="id" title="var">S</span> <span class="id" title="var">n</span>) → <span class="id" title="tactic">∃</span> (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w'</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), <span class="id" title="var">w</span> = (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w'</span>).<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">∃</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Principe&nbsp;d'induction&nbsp;sur&nbsp;la&nbsp;longueur&nbsp;des&nbsp;listes&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">list_length_ind_S</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span>: (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;→ (<span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="keyword">∀</span> (<span class="id" title="var">xs</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → (<span class="id" title="var">P</span> <span class="id" title="var">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" title="keyword">∀</span> (<span class="id" title="var">xs</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>)=(<span class="id" title="var">S</span> <span class="id" title="var">n</span>) → (<span class="id" title="var">P</span> <span class="id" title="var">xs</span>))<br/>
&nbsp;&nbsp;→ <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">xs</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) → (<span class="id" title="var">P</span> <span class="id" title="var">xs</span>)).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">P0</span> <span class="id" title="var">Plt</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">assert</span> (<span class="id" title="var">xs</span>=<span class="id" title="var">nil</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">length_0_nil</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">lt_1_0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">elim</span> (<span class="id" title="var">lt_S_case</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Plt</span> <span class="id" title="var">n</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">list_length_ind</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span>: (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">P</span> <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;→ (<span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="keyword">∀</span> (<span class="id" title="var">xs</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → (<span class="id" title="var">P</span> <span class="id" title="var">xs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" title="keyword">∀</span> (<span class="id" title="var">xs</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>)=(<span class="id" title="var">S</span> <span class="id" title="var">n</span>) → (<span class="id" title="var">P</span> <span class="id" title="var">xs</span>))<br/>
&nbsp;&nbsp;→ <span class="id" title="keyword">∀</span> (<span class="id" title="var">xs</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">P</span> <span class="id" title="var">xs</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">list_length_ind_S</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=(<span class="id" title="var">length</span> <span class="id" title="var">xs</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Extension&nbsp;d'une&nbsp;liste&nbsp;avec&nbsp;des&nbsp;0&nbsp;(en&nbsp;tête)&nbsp;*)</span><br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">zs</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) ⇒ (<span class="id" title="var">cons</span> 0 (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">zs_len</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="var">length</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>))=<span class="id" title="var">n</span>.<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Complétion&nbsp;d'une&nbsp;liste&nbsp;en&nbsp;fonction&nbsp;d'une&nbsp;autre.&nbsp;<br/>
&nbsp;&nbsp;&nbsp;Le&nbsp;résultat&nbsp;est&nbsp;une&nbsp;liste&nbsp;de&nbsp;la&nbsp;longueur&nbsp;de&nbsp;la<br/>
&nbsp;&nbsp;&nbsp;plus&nbsp;grande.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">dist</span> (<span class="id" title="var">w1</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">minus</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">padd</span> (<span class="id" title="var">w1</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> (<span class="id" title="var">dist</span> <span class="id" title="var">w2</span> <span class="id" title="var">w1</span>)) <span class="id" title="var">w1</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padd_len_lt_cons</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)) <br/>
&nbsp;&nbsp;→ <span class="id" title="tactic">∃</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">padd</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>)=(<span class="id" title="var">cons</span> 0 <span class="id" title="var">w</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">padd</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">dist</span>.<br/>
<span class="id" title="tactic">elim</span> (<span class="id" title="var">minus_lt_S</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) <span class="id" title="var">H</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">∃</span> (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">x</span>) <span class="id" title="var">w1</span>). <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padd_len_le_len</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">le</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>))<br/>
&nbsp;&nbsp;→ (<span class="id" title="var">length</span> (<span class="id" title="var">padd</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>)) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">padd</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">dist</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">length_app</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">zs_len</span>.<br/>
<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_add</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">exact</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">padd_cons_0</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">padd</span> <span class="id" title="var">w1</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w2</span>)) = (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w1</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">padd</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">dist</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="var">length</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">minus_Sn_n</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Sur l'accessibilité.
  Tribute to P. Casteran: 
      http://www.labri.fr/perso/casteran/Cantor/HTML/AccP.htmlAccElim3

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">AccElim2</span> :<br/>
<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Set</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">RA</span>: <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">RB</span>: <span class="id" title="var">B</span> → <span class="id" title="var">B</span> → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span> → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <span class="id" title="var">A</span>), <span class="id" title="var">RA</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">y'</span>, <span class="id" title="var">Acc</span> <span class="id" title="var">RB</span> <span class="id" title="var">y'</span> → <span class="id" title="var">P</span> <span class="id" title="var">t</span> <span class="id" title="var">y'</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <span class="id" title="var">B</span>), <span class="id" title="var">RB</span> <span class="id" title="var">t</span> <span class="id" title="var">y</span> → <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">t</span>) → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)) →<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">Acc</span> <span class="id" title="var">RA</span> <span class="id" title="var">x</span> → <span class="id" title="var">Acc</span> <span class="id" title="var">RB</span> <span class="id" title="var">y</span> → <span class="id" title="var">P</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">RA</span> <span class="id" title="var">RB</span> <span class="id" title="var">P</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">Ax</span>; <span class="id" title="tactic">generalize</span> <span class="id" title="var">y</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">y</span>.<br/>
&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Ax</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ax</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">HAccx</span> <span class="id" title="var">Hrecx</span> <span class="id" title="var">y</span> <span class="id" title="var">Ay</span>.<br/>
&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Ay</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Ay</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">HAccy</span> <span class="id" title="var">Hrecy</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Relation d'ordre sur les listes d'entiers considérés comme des
  ordinaux (formes normales de Cantor à exposants finis).

</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">wlt</span> : (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wlt_nil</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>)(<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">wlt</span> <span class="id" title="var">nil</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w</span>))<br/>
| <span class="id" title="var">wlt_0_w</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w1</span>) <span class="id" title="var">w2</span>)<br/>
| <span class="id" title="var">wlt_w_0</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w2</span>))<br/>
| <span class="id" title="var">wlt_len</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span> &lt; <span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a1</span>) <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a2</span>) <span class="id" title="var">w2</span>))<br/>
| <span class="id" title="var">wlt_lt</span> :  <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span> = <span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">lt</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a1</span>) <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a2</span>) <span class="id" title="var">w2</span>))<br/>
| <span class="id" title="var">wlt_wlt</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span> = <span class="id" title="var">length</span> <span class="id" title="var">w2</span>) →  (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w2</span>)).<br/>

<br/>
<span class="comment">(*&nbsp;'nil'&nbsp;est&nbsp;minimal&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_wlt_nil</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), <br/>
&nbsp;&nbsp;<span class="id" title="var">not</span> (<span class="id" title="var">wlt</span> <span class="id" title="var">w</span> <span class="id" title="var">nil</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">case</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Lemmes&nbsp;d'inversion&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_0_w_inv</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w1</span>) <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">absurd</span> (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w1</span>) <span class="id" title="var">nil</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">not_wlt_nil</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_w_0_inv</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w2</span>)) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Autres&nbsp;résultats&nbsp;négatifs&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_wlt_len_left</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">le</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>)) → <span class="id" title="var">not</span> (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w1</span>) <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">not_wlt_nil</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="var">absurd</span> (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a0</span>) <span class="id" title="var">w1</span>) <span class="id" title="var">w2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHw2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.le_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span>:=(<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0_inv</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w2</span>)) (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.le_lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span> := (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>)); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">not_lt_Sn_n</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">not_le_Sn_n</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">not_le_Sn_n</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)); <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_wlt_Sn_0</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → <span class="id" title="var">not</span> (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w2</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">not_wlt_len_left</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0_inv</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_wlt_len</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w2</span> ≤ <span class="id" title="var">length</span> <span class="id" title="var">w1</span>) → <span class="id" title="var">not</span> (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w1</span>) <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">not_wlt_nil</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w1</span>)). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">case</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHw2</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">a</span>:=<span class="id" title="var">a0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.le_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span>:=(<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w2</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0_inv</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.lt_irrefl</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span>:=(<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)); <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.nle_succ_diag_l</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H4</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.nle_succ_diag_l</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)). <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Invariance&nbsp;de&nbsp;'wlt'&nbsp;pour&nbsp;la&nbsp;complétion&nbsp;à&nbsp;0&nbsp;(en&nbsp;tête)&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_wlt_zs_right</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>) <span class="id" title="var">w2</span>)).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_zs_wlt_right</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>) <span class="id" title="var">w2</span>)) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHn</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0_inv</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_wlt_zs_left</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>) <span class="id" title="var">w1</span>) (<span class="id" title="var">w2</span>)).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Caractérisation&nbsp;en&nbsp;fonction&nbsp;de&nbsp;la&nbsp;longueur:<br/>
&nbsp;&nbsp;&nbsp;si&nbsp;'(wlt&nbsp;w1&nbsp;w2)'&nbsp;et&nbsp;'w2 < w1'&nbsp;alors&nbsp;'w1'&nbsp;commence&nbsp;par&nbsp;des&nbsp;0&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_gt_length</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>))<br/>
&nbsp;&nbsp;→ <span class="id" title="tactic">∃</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">w1</span> = (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>) <span class="id" title="var">w</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧ (<span class="id" title="var">length</span> <span class="id" title="var">w</span>)=(<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;∧ (<span class="id" title="var">wlt</span> <span class="id" title="var">w</span> <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span> <span class="id" title="var">w1</span> <span class="id" title="var">IHw1</span>]; [<span class="id" title="tactic">intros</span> <span class="id" title="var">w2</span> <span class="id" title="var">_</span> []%<span class="id" title="var">Nat.nlt_0_r</span> |].<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">w2</span> <span class="id" title="var">H</span> <span class="id" title="var">Hl</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>; <span class="id" title="tactic">apply</span> &lt;-<span class="id" title="var">Nat.succ_le_mono</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span>.<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">a</span>].<br/>
- <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.le_lteq</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hl</span> | <span class="id" title="var">Hl</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w_inv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">specialize</span> (<span class="id" title="var">IHw1</span> <span class="id" title="var">w2</span> <span class="id" title="var">H</span> <span class="id" title="var">Hl</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> [<span class="id" title="var">w'</span> [<span class="id" title="var">H'1</span> [<span class="id" title="var">H'2</span> <span class="id" title="var">H'3</span>]]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">∃</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>); <span class="id" title="tactic">∃</span> <span class="id" title="var">w'</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H'1</span> | <span class="id" title="tactic">split</span>].<br/>
&nbsp;&nbsp;+ <span class="id" title="tactic">∃</span> (<span class="id" title="var">S</span> 0); <span class="id" title="tactic">∃</span> <span class="id" title="var">w1</span>; <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">reflexivity</span> | <span class="id" title="tactic">split</span>]; [<span class="id" title="var">now</span> <span class="id" title="tactic">symmetry</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> (<span class="id" title="var">wlt_0_w_inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>
- <span class="id" title="var">now</span> <span class="id" title="var">exfalso</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">not_wlt_len_left</span> <span class="id" title="keyword">with</span> (2 := <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
   Restriction de l'ordre aux listes de même longueur.
   (avec complémentation possible à 0): 
   c'est l'ordre lexicographique.

</div>
<div class="code">
<span class="comment">(*&nbsp;La&nbsp;relation&nbsp;sur&nbsp;les&nbsp;listes&nbsp;de&nbsp;même&nbsp;longueur&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">wlt_pad</span> : (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wlt_pad_len</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">le</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">wlt_pad</span> (<span class="id" title="var">padd</span>  <span class="id" title="var">w1</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w2</span>)) (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w2</span>))<br/>
| <span class="id" title="var">wlt_pad_lt</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">lt</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">wlt_pad</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a1</span>) <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a2</span>) <span class="id" title="var">w2</span>))<br/>
| <span class="id" title="var">wlt_pad_wlt_pad</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt_pad</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">wlt_pad</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w2</span>)).<br/>

<br/>
<span class="comment">(*&nbsp;Relations&nbsp;entre&nbsp;l'ordre&nbsp;sur&nbsp;toute&nbsp;liste&nbsp;et&nbsp;l'ordre&nbsp;restreint.&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_wlt_pad</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>)<br/>
&nbsp;&nbsp;→ (<span class="id" title="var">wlt_pad</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">w1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">w1</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">w2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">not_wlt_nil</span> <span class="id" title="var">w1</span>). <span class="id" title="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;1:&nbsp;wlt_0_w&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_pad_wlt_pad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHw2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0_inv</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">padd_cons_0</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_pad_len</span>. <span class="id" title="tactic">injection</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;2:&nbsp;wlt_w_0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_pad_wlt_pad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHw2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0_inv</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w_inv</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">not_wlt_Sn_0</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span> <span class="id" title="var">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;3&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.lt_irrefl</span> (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>)). <span class="id" title="tactic">injection</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H6</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;4&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_pad_lt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;5&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_pad_wlt_pad</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHw2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_wlt_pad_zs</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) &lt; (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>)<br/>
&nbsp;&nbsp;→ (<span class="id" title="var">wlt_pad</span> (<span class="id" title="var">padd</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) <span class="id" title="var">w2</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_pad</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">padd_len_le_len</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_zs_left</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Accessibilité pour l'ordre restreint.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_pad_ind</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">w</span>) (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">Acc</span> <span class="id" title="var">wlt_pad</span> <span class="id" title="var">w</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">length</span> <span class="id" title="var">w</span>)=(<span class="id" title="var">S</span> <span class="id" title="var">n</span>) → <span class="id" title="var">Acc</span> <span class="id" title="var">wlt_pad</span> <span class="id" title="var">w</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">elim</span> (<span class="id" title="var">length_Sn_cons</span> <span class="id" title="var">w</span> <span class="id" title="var">n</span> <span class="id" title="var">H0</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">w'</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="var">H0</span>.<br/>
<span class="id" title="tactic">pattern</span> <span class="id" title="var">a</span>, <span class="id" title="var">w'</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">AccElim2</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">RA</span>:=<span class="id" title="var">lt</span>) (<span class="id" title="var">RB</span>:=<span class="id" title="var">wlt_pad</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a'</span> <span class="id" title="var">w''</span> <span class="id" title="var">H1</span> <span class="id" title="var">H2</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_intro</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">w'''</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H4</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> (<span class="id" title="var">padd_len_lt_cons</span>  <span class="id" title="var">w1</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a0</span>) <span class="id" title="var">w''</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">w0</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H9</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H5</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w0</span>)) (<span class="id" title="var">S</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">padd_len_le_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H9</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">padd_len_le_len</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H5</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H8</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H3</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H8</span>. <span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H8</span>. <span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lt_wf</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H0</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>

<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_pad_nil</span> : (<span class="id" title="var">Acc</span> <span class="id" title="var">wlt_pad</span> <span class="id" title="var">nil</span>).<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_intro</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_pad</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">Acc</span> <span class="id" title="var">wlt_pad</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span> <span class="id" title="keyword">using</span> <span class="id" title="var">list_length_ind</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_pad_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_pad_ind</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=<span class="id" title="var">n</span>); <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  De l'accessibilté pour l'ordre restreint à l'accessibilité
  pour l'ordre sur tout liste.

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_zs_Acc_wlt</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">Acc</span> <span class="id" title="var">wlt</span> (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>) <span class="id" title="var">w</span>)) → (<span class="id" title="var">Acc</span> <span class="id" title="var">wlt</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_intro</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">w'</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_zs_right</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_Acc_wlt_zs</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">Acc</span> <span class="id" title="var">wlt</span> <span class="id" title="var">w</span>) → (<span class="id" title="var">Acc</span> <span class="id" title="var">wlt</span> (<span class="id" title="var">app</span> (<span class="id" title="var">zs</span> <span class="id" title="var">n</span>) <span class="id" title="var">w</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_intro</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">w'</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_zs_wlt_right</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=<span class="id" title="var">n</span>). <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_pad_Acc_wlt</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)),<br/>
&nbsp;&nbsp;(<span class="id" title="var">Acc</span> <span class="id" title="var">wlt_pad</span> <span class="id" title="var">w</span>) → (<span class="id" title="var">Acc</span> <span class="id" title="var">wlt</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">w'</span> <span class="id" title="var">H0</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_intro</span>.<br/>
<span class="id" title="tactic">intros</span> <span class="id" title="var">w''</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">elim</span> (<span class="id" title="var">nat_compare_case</span> (<span class="id" title="var">length</span> <span class="id" title="var">w''</span>) (<span class="id" title="var">length</span> <span class="id" title="var">w'</span>)).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;w'' < w'&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_zs_Acc_wlt</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">n</span>:=(<span class="id" title="var">dist</span> <span class="id" title="var">w'</span> <span class="id" title="var">w''</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_pad_zs</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;w'' = w4&nbsp;\/&nbsp;w' < w''&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">elim</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;w'' = w'&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_pad</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;w' < w''&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">elim</span> (<span class="id" title="var">wlt_gt_length</span> <span class="id" title="var">w''</span> <span class="id" title="var">w'</span> <span class="id" title="var">H2</span> <span class="id" title="var">H4</span>). <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">w0</span>. <span class="id" title="tactic">intro</span>. <span class="id" title="var">decompose</span> [<span class="id" title="var">and</span>] <span class="id" title="var">H6</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H7</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_Acc_wlt_zs</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_pad</span>; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  L'ordre sur toute liste est bien fondé !

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">Acc_wlt</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:(<span class="id" title="var">list</span> <span class="id" title="var">nat</span>)), (<span class="id" title="var">Acc</span> <span class="id" title="var">wlt</span> <span class="id" title="var">w</span>).<br/>
<span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_pad_Acc_wlt</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_pad</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
   Sur wlt

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_len_gen</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">lt</span> (<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w2</span>))) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) <span class="id" title="var">w2</span>)).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHw1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Nat.lt_trans</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">m</span>:=(<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> 0 <span class="id" title="var">w1</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_len</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_lt_gen</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">lt</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a1</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">a2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">exfalso</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">Nat.nlt_0_r</span> <span class="id" title="var">a1</span>). <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_len_gen</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_wlt_gen</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">w1</span> <span class="id" title="var">w2</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">length</span> <span class="id" title="var">w1</span>) = (<span class="id" title="var">length</span> <span class="id" title="var">w2</span>) → (<span class="id" title="var">wlt</span> <span class="id" title="var">w1</span> <span class="id" title="var">w2</span>) <br/>
&nbsp;&nbsp;→ (<span class="id" title="var">wlt</span> (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w1</span>) (<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">w2</span>)).<br/>
<span class="id" title="tactic">destruct</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_w_0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt</span>; <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wlt_wf_ind</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">P</span>: (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) → <span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> (<span class="id" title="var">w1</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>), (<span class="id" title="keyword">∀</span> (<span class="id" title="var">w2</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>), (<span class="id" title="var">wlt</span> <span class="id" title="var">w2</span> <span class="id" title="var">w1</span>) → <span class="id" title="var">P</span> <span class="id" title="var">w2</span>) → <span class="id" title="var">P</span> <span class="id" title="var">w1</span>)<br/>
&nbsp;&nbsp;→ <span class="id" title="keyword">∀</span> (<span class="id" title="var">w</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>), <span class="id" title="var">P</span> <span class="id" title="var">w</span>.<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">well_founded_ind</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">R</span>:=<span class="id" title="var">wlt</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">assumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Utilitaire&nbsp;pour&nbsp;la&nbsp;définition&nbsp;des&nbsp;ordres&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">make_mwlt</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">A</span> → <span class="id" title="var">list</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> (<span class="id" title="var">m</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">m</span> <span class="id" title="var">a2</span>)).<br/>

<br/>
</div>

<div class="doc">
Un ordre basé sur une mesure ordinale est bien fondé 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_wlt_eq</span> : <br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">m</span>: <span class="id" title="var">A</span> → <span class="id" title="var">list</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">w</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) , <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> = (<span class="id" title="var">m</span> <span class="id" title="var">x</span>) → (<span class="id" title="var">Acc</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">A</span> ⇒ <span class="id" title="var">wlt</span> (<span class="id" title="var">m</span> <span class="id" title="var">x1</span>) (<span class="id" title="var">m</span> <span class="id" title="var">x2</span>)) <span class="id" title="var">x</span>).<br/>
<span class="id" title="tactic">induction</span> <span class="id" title="var">w</span> <span class="id" title="keyword">using</span> <span class="id" title="var">wlt_wf_ind</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_intro</span>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">w2</span>:=(<span class="id" title="var">m</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Acc_mwlt</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">m</span>: <span class="id" title="var">A</span> → <span class="id" title="var">list</span> <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>), (<span class="id" title="var">Acc</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> ⇒ (<span class="id" title="var">wlt</span> (<span class="id" title="var">m</span> <span class="id" title="var">x1</span>) (<span class="id" title="var">m</span> <span class="id" title="var">x2</span>))) <span class="id" title="var">x</span>).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_wlt_eq</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">w</span>:=(<span class="id" title="var">m</span> <span class="id" title="var">x</span>)). <span class="id" title="tactic">trivial</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
  Applications avec Program Fixpoint

</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="var">Program.Wf</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Tactique&nbsp;pour&nbsp;les&nbsp;preuves&nbsp;de&nbsp;bonne&nbsp;fondation.&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">mwlt</span> := <br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">Wf.MR</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">well_founded</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">mwlt</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">Acc_mwlt</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Ordre&nbsp;lexicographique&nbsp;sur&nbsp;les&nbsp;entiers&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">wm_natxnat</span> (<span class="id" title="var">xy</span>:<span class="id" title="var">nat</span>×<span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) ⇒ (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> (<span class="id" title="var">cons</span> <span class="id" title="var">y</span> <span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_natxnat</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">make_mwlt</span> (<span class="id" title="var">nat</span>×<span class="id" title="var">nat</span>) <span class="id" title="var">wm_natxnat</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lex_natxnat_fst</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x1</span> <span class="id" title="var">y1</span> <span class="id" title="var">x2</span> <span class="id" title="var">y2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>) → (<span class="id" title="var">lex_natxnat</span> (<span class="id" title="var">x1</span>,<span class="id" title="var">y1</span>) (<span class="id" title="var">x2</span>,<span class="id" title="var">y2</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_natxnat</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lex_natxnat_snd</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>) → (<span class="id" title="var">lex_natxnat</span> (<span class="id" title="var">x</span>,<span class="id" title="var">y1</span>) (<span class="id" title="var">x</span>,<span class="id" title="var">y2</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_natxnat</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">ack_like</span> (<span class="id" title="var">xy</span>:<span class="id" title="var">nat</span>×<span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> <span class="id" title="var">lex_natxnat</span> <span class="id" title="var">xy</span>} : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0, <span class="id" title="var">y</span>) ⇒ (<span class="id" title="var">S</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, 0) ⇒ (<span class="id" title="var">ack_like</span> (<span class="id" title="var">x</span>, <span class="id" title="var">S</span> 0))<br/>
&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">S</span> <span class="id" title="var">y</span>) ⇒ (<span class="id" title="var">ack_like</span> (<span class="id" title="var">x</span>, (<span class="id" title="var">x</span> + <span class="id" title="var">y</span>))) +  (<span class="id" title="var">ack_like</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_natxnat_fst</span>.<br/>
<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_natxnat_fst</span>.<br/>
<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_natxnat_snd</span>.<br/>
<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 4.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lex_natxnat</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">ack</span> (<span class="id" title="var">xy</span>:<span class="id" title="var">nat</span>×<span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> <span class="id" title="var">lex_natxnat</span> <span class="id" title="var">xy</span>} : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xy</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(0, <span class="id" title="var">y</span>) ⇒ (<span class="id" title="var">S</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, 0) ⇒ (<span class="id" title="var">ack</span> (<span class="id" title="var">x</span>, <span class="id" title="var">S</span> 0))<br/>
&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">S</span> <span class="id" title="var">y</span>) ⇒ (<span class="id" title="var">ack</span> (<span class="id" title="var">x</span>, <span class="id" title="var">ack</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_natxnat_fst</span>.<br/>
<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_natxnat_snd</span>.<br/>
<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">lex_natxnat_fst</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">Heq_xy</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 4.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lex_natxnat</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Ordre&nbsp;lexicographique&nbsp;sur&nbsp;les&nbsp;longueurs&nbsp;des&nbsp;listes&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">wm_listxlist</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">xys</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span> × <span class="id" title="var">list</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xys</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">xs</span>,<span class="id" title="var">ys</span>) ⇒ (<span class="id" title="var">wm_natxnat</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>, <span class="id" title="var">length</span> <span class="id" title="var">ys</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lex_listxlist</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">make_mwlt</span> (<span class="id" title="var">list</span> <span class="id" title="var">A</span> × <span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">wm_listxlist</span> <span class="id" title="var">A</span>)).<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">ltb</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">bool</span>.<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">merge</span> (<span class="id" title="var">xys</span>: <span class="id" title="var">list</span> <span class="id" title="var">nat</span> × <span class="id" title="var">list</span> <span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> (<span class="id" title="var">lex_listxlist</span> <span class="id" title="var">nat</span>) <span class="id" title="var">xys</span>} : <span class="id" title="var">list</span> <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xys</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">nil</span>, <span class="id" title="var">ys</span>) ⇒ <span class="id" title="var">ys</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">xs</span>, <span class="id" title="var">nil</span>) ⇒ <span class="id" title="var">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span>, <span class="id" title="var">cons</span> <span class="id" title="var">y</span> <span class="id" title="var">ys</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">ltb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">then</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> (<span class="id" title="var">merge</span> (<span class="id" title="var">xs</span>, (<span class="id" title="var">cons</span> <span class="id" title="var">y</span> <span class="id" title="var">ys</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="var">cons</span> <span class="id" title="var">y</span> (<span class="id" title="var">merge</span> ((<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span>), <span class="id" title="var">ys</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_listxlist</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_listxlist</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 4.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lex_natxnat</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Ordre&nbsp;sur&nbsp;les&nbsp;listes&nbsp;d'entiers:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ordre&nbsp;lexicographique&nbsp;sur&nbsp;la&nbsp;taille&nbsp;et&nbsp;le&nbsp;premier&nbsp;élément&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">m_list</span> (<span class="id" title="var">xs</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span>) ⇒ (<span class="id" title="var">cons</span> (<span class="id" title="var">length</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span>)) (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_list</span>  :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">make_mwlt</span> (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) <span class="id" title="var">m_list</span>).<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">sum_list</span> (<span class="id" title="var">xs</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> <span class="id" title="var">lt_list</span> <span class="id" title="var">xs</span>} : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> 0 <span class="id" title="var">xs</span>) ⇒ (<span class="id" title="var">sum_list</span> <span class="id" title="var">xs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>) <span class="id" title="var">xs</span>) ⇒ <span class="id" title="var">S</span> (<span class="id" title="var">sum_list</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_list</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_list</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lex_natxnat</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Analogue&nbsp;sur&nbsp;les&nbsp;listes&nbsp;de&nbsp;listes&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">m_listlist</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">xss</span> : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">A</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xss</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">xs</span> <span class="id" title="var">_</span>) ⇒ (<span class="id" title="var">cons</span> (<span class="id" title="var">length</span> <span class="id" title="var">xss</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) <span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_listlist</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">xss</span> <span class="id" title="var">yss</span> : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">A</span>)) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> (<span class="id" title="var">m_listlist</span> <span class="id" title="var">A</span> <span class="id" title="var">xss</span>) (<span class="id" title="var">m_listlist</span> <span class="id" title="var">A</span> <span class="id" title="var">yss</span>)).<br/>

<br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>.<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">list_concat</span> (<span class="id" title="var">xss</span> : <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">A</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="keyword">wf</span> (<span class="id" title="var">lt_listlist</span> <span class="id" title="var">A</span>) <span class="id" title="var">xss</span>} : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xss</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">nil</span> <span class="id" title="var">xss</span>) ⇒ (<span class="id" title="var">list_concat</span> <span class="id" title="var">xss</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">xs</span>) <span class="id" title="var">xss</span>) ⇒ (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> (<span class="id" title="var">list_concat</span> (<span class="id" title="var">cons</span> <span class="id" title="var">xs</span> <span class="id" title="var">xss</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_listlist</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">xss</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_listlist</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lex_natxnat</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Sur&nbsp;la&nbsp;longueur&nbsp;des&nbsp;listes&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mw_list</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">xs</span>: <span class="id" title="var">list</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">cons</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) <span class="id" title="var">nil</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_len_list</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">make_mwlt</span> (<span class="id" title="var">list</span> <span class="id" title="var">A</span>) (<span class="id" title="var">mw_list</span> <span class="id" title="var">A</span>)).<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">bubble</span> (<span class="id" title="var">xs</span>:<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> (<span class="id" title="var">lt_len_list</span> <span class="id" title="var">nat</span>) <span class="id" title="var">xs</span>} : <span class="id" title="var">list</span> <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">nil</span>) ⇒ (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">x1</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x2</span> <span class="id" title="var">xs</span>)) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">ltb</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span>) <span class="id" title="keyword">then</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x1</span> (<span class="id" title="var">bubble</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x2</span> <span class="id" title="var">xs</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x2</span> (<span class="id" title="var">bubble</span> (<span class="id" title="var">cons</span> <span class="id" title="var">x1</span> <span class="id" title="var">xs</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_len_list</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">mw_list</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_len_list</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">mw_list</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lt_len_list</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Le&nbsp;peigne&nbsp;*)</span><br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">btree</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) : <span class="id" title="keyword">Set</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Empty</span> : (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>)<br/>
| <span class="id" title="var">Node</span> : (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>) → <span class="id" title="var">A</span> → (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>) → (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Arguments</span>  <span class="id" title="var">Empty</span> {<span class="id" title="var">A</span>}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">Node</span> [<span class="id" title="var">A</span>] <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">btree_size</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">bt</span>:<span class="id" title="var">btree</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">bt</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Empty</span> ⇒ 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">Node</span> <span class="id" title="var">bt1</span> <span class="id" title="var">x</span> <span class="id" title="var">bt2</span>) ⇒ <span class="id" title="var">S</span> (<span class="id" title="var">plus</span> (<span class="id" title="var">btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bt1</span>) (<span class="id" title="var">btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bt2</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">m_btree</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">bt</span>:<span class="id" title="var">btree</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">bt</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Empty</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">Node</span> <span class="id" title="var">bt1</span> <span class="id" title="var">x</span> <span class="id" title="var">bt2</span>) ⇒ (<span class="id" title="var">cons</span> (<span class="id" title="var">btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bt</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bt1</span>) <span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_btree</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">bt1</span> <span class="id" title="var">bt2</span>:<span class="id" title="var">btree</span> <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">wlt</span> (<span class="id" title="var">m_btree</span> <span class="id" title="var">A</span> <span class="id" title="var">bt1</span>) (<span class="id" title="var">m_btree</span> <span class="id" title="var">A</span> <span class="id" title="var">bt2</span>)).<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">to_list</span> (<span class="id" title="var">bt</span>:<span class="id" title="var">btree</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="keyword">wf</span> (<span class="id" title="var">lt_btree</span> <span class="id" title="var">A</span>) <span class="id" title="var">bt</span>} : <span class="id" title="var">list</span> <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">bt</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Empty</span> ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">Node</span> <span class="id" title="var">Empty</span> <span class="id" title="var">x</span> <span class="id" title="var">bt</span>) ⇒ (<span class="id" title="var">cons</span> <span class="id" title="var">x</span> (<span class="id" title="var">to_list</span> <span class="id" title="var">bt</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">Node</span> (<span class="id" title="var">Node</span> <span class="id" title="var">bt1</span> <span class="id" title="var">x1</span> <span class="id" title="var">bt2</span>) <span class="id" title="var">x2</span> <span class="id" title="var">bt3</span>) ⇒ (<span class="id" title="var">to_list</span> (<span class="id" title="var">Node</span> <span class="id" title="var">bt1</span> <span class="id" title="var">x1</span> (<span class="id" title="var">Node</span> <span class="id" title="var">bt2</span> <span class="id" title="var">x2</span> <span class="id" title="var">bt3</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_btree</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">bt</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_btree</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Nat.add_succ_comm</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_assoc</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lt_btree</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Theory&nbsp;*)</span><br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g1</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g2</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g3</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g4</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g5</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g6</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">g7</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">h1</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">h2</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">h3</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">wm_nat3</span> (<span class="id" title="var">xyz</span>:<span class="id" title="var">nat</span> × <span class="id" title="var">nat</span> × <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xyz</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0, <span class="id" title="var">y</span>, 0) ⇒ <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (0, <span class="id" title="var">y</span>, <span class="id" title="var">S</span> <span class="id" title="var">z</span>) ⇒ (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">z</span>) <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, 0, <span class="id" title="var">z</span>) ⇒ (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>) (<span class="id" title="var">cons</span> 0 <span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">S</span> <span class="id" title="var">y</span>, <span class="id" title="var">z</span>) ⇒ (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">y</span>) <span class="id" title="var">nil</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">rlex_nat3</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">make_mwlt</span> (<span class="id" title="var">nat</span> × <span class="id" title="var">nat</span> × <span class="id" title="var">nat</span>) <span class="id" title="var">wm_nat3</span>).<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">f</span> (<span class="id" title="var">xyz</span> : <span class="id" title="var">nat</span> × <span class="id" title="var">nat</span> × <span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> <span class="id" title="var">rlex_nat3</span> <span class="id" title="var">xyz</span>} : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xyz</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0, <span class="id" title="var">y</span>, 0) ⇒ (<span class="id" title="var">g1</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (0, <span class="id" title="var">y</span>, <span class="id" title="var">S</span> <span class="id" title="var">z</span>) ⇒ (<span class="id" title="var">h1</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> (<span class="id" title="var">f</span> (0, (<span class="id" title="var">g2</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>), <span class="id" title="var">z</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, 0, <span class="id" title="var">z</span>) ⇒ (<span class="id" title="var">h2</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span> (<span class="id" title="var">f</span> (<span class="id" title="var">x</span>, (<span class="id" title="var">g3</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>), (<span class="id" title="var">g4</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">S</span> <span class="id" title="var">y</span>, <span class="id" title="var">z</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h3</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> (<span class="id" title="var">f</span> (<span class="id" title="var">x</span>, (<span class="id" title="var">g5</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>), (<span class="id" title="var">g6</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>, (<span class="id" title="var">g7</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>))))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rlex_nat3_1</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">rlex_nat3</span> (0, <span class="id" title="var">y</span>, <span class="id" title="var">z</span>) (0, <span class="id" title="var">m</span>, <span class="id" title="var">S</span> <span class="id" title="var">z</span>)).<br/>
<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">rlex_nat3</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rlex_nat3_2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">z</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">rlex_nat3</span> (<span class="id" title="var">x</span>, <span class="id" title="var">m1</span>, <span class="id" title="var">m2</span>) (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, 0, <span class="id" title="var">z</span>)).<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">rlex_nat3</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_len</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rlex_nat3_3</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">rlex_nat3</span> (<span class="id" title="var">x</span>, <span class="id" title="var">m1</span>, <span class="id" title="var">m2</span>) (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">S</span> <span class="id" title="var">y</span>, <span class="id" title="var">z</span>)).<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">rlex_nat3</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_len</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">m1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">rlex_nat3_4</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">rlex_nat3</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span>, <span class="id" title="var">m</span>) (<span class="id" title="var">S</span> <span class="id" title="var">x</span>, <span class="id" title="var">S</span> <span class="id" title="var">y</span>, <span class="id" title="var">z</span>)).<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">rlex_nat3</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_0_w</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_nil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rlex_nat3_1</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rlex_nat3_2</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rlex_nat3_3</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 4.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">rlex_nat3_4</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 5.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">wm_nat3</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Bootstrap&nbsp;*)</span><br/>
<span class="id" title="keyword">Parameter</span> <span class="id" title="var">eqb</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">bool</span>.<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">listordi</span> (<span class="id" title="var">xsys</span> : <span class="id" title="var">list</span> <span class="id" title="var">nat</span> × <span class="id" title="var">list</span> <span class="id" title="var">nat</span>) {<span class="id" title="keyword">wf</span> (<span class="id" title="var">lex_listxlist</span> <span class="id" title="var">nat</span>) <span class="id" title="var">xsys</span>} : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">xsys</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">_</span>, <span class="id" title="var">nil</span>) ⇒ <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">xs</span>, (<span class="id" title="var">cons</span> 0 <span class="id" title="var">ys</span>)) ⇒ (<span class="id" title="var">listordi</span> (<span class="id" title="var">xs</span>, <span class="id" title="var">ys</span>))<br/>
&nbsp;&nbsp;| (<span class="id" title="var">nil</span>, (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">y</span>) <span class="id" title="var">ys</span>)) ⇒ <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| ((<span class="id" title="var">cons</span> 0 <span class="id" title="var">xs</span>), (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">y</span>) <span class="id" title="var">ys</span>)) ⇒ (<span class="id" title="var">listordi</span> (<span class="id" title="var">xs</span>, (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">y</span>) <span class="id" title="var">ys</span>)))<br/>
&nbsp;&nbsp;| ((<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">x</span>) <span class="id" title="var">xs</span>), (<span class="id" title="var">cons</span> (<span class="id" title="var">S</span> <span class="id" title="var">y</span>) <span class="id" title="var">ys</span>)) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">orb</span> (<span class="id" title="var">ltb</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">length</span> <span class="id" title="var">ys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">andb</span> (<span class="id" title="var">eqb</span> (<span class="id" title="var">length</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">length</span> <span class="id" title="var">ys</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">orb</span> (<span class="id" title="var">ltb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="var">listordi</span> (<span class="id" title="var">xs</span>, <span class="id" title="var">ys</span>)))))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_listxlist</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_listxlist</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lex_listxlist</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">simpl</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 4.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lex_natxnat</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Dershowitz/Manna:&nbsp;"counting&nbsp;tips&nbsp;of&nbsp;binary&nbsp;trees"&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">list_btree_size</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">bts</span>:<span class="id" title="var">list</span> (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>)) : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">bts</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">bt</span> <span class="id" title="var">bts</span>) ⇒ (<span class="id" title="var">plus</span> (<span class="id" title="var">btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bt</span>) (<span class="id" title="var">list_btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bts</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">wm_list_btree</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) (<span class="id" title="var">bts</span>:<span class="id" title="var">list</span> (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>)) : (<span class="id" title="var">list</span> <span class="id" title="var">nat</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">cons</span> (<span class="id" title="var">list_btree_size</span> <span class="id" title="var">A</span> <span class="id" title="var">bts</span>) (<span class="id" title="var">cons</span> (<span class="id" title="var">length</span> <span class="id" title="var">bts</span>) <span class="id" title="var">nil</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_list_btree</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Set</span>) :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">make_mwlt</span> (<span class="id" title="var">list</span> (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>)) (<span class="id" title="var">wm_list_btree</span> <span class="id" title="var">A</span>)).<br/>

<br/>
<span class="id" title="keyword">Program Fixpoint</span> <span class="id" title="var">count_tips</span> (<span class="id" title="var">bts</span>:(<span class="id" title="var">list</span> (<span class="id" title="var">btree</span> <span class="id" title="var">A</span>))) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="keyword">wf</span> (<span class="id" title="var">lt_list_btree</span> <span class="id" title="var">A</span>) <span class="id" title="var">bts</span>} : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">bts</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> ⇒ 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> <span class="id" title="var">Empty</span> <span class="id" title="var">bts</span>) ⇒ <span class="id" title="var">S</span> (<span class="id" title="var">count_tips</span> <span class="id" title="var">bts</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> (<span class="id" title="var">Node</span> <span class="id" title="var">bt1</span> <span class="id" title="var">x</span> <span class="id" title="var">bt2</span>) <span class="id" title="var">bts</span>) ⇒ (<span class="id" title="var">count_tips</span> (<span class="id" title="var">cons</span> <span class="id" title="var">bt1</span> (<span class="id" title="var">cons</span> <span class="id" title="var">bt2</span> <span class="id" title="var">bts</span>)))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 1.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_list_btree</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wm_list_btree</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_wlt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>; <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 2.<br/>
<span class="id" title="tactic">unfold</span> <span class="id" title="var">lt_list_btree</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">make_mwlt</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">wm_list_btree</span>.<br/>
<span class="id" title="tactic">apply</span> <span class="id" title="var">wlt_lt_gen</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_assoc</span>. <span class="id" title="tactic">auto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">arith</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Obligation</span> 3.<br/>
<span class="id" title="var">by_Acc_mwlt</span> <span class="id" title="var">lt_list_btree</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="keyword">Assumptions</span> <span class="id" title="var">count_tips</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>