<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Examples.HoTT_light</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<div class="code">
</div>

<div class="doc">
<a id="lab1"></a><h1 class="section">HoTT-light</h1>

<a id="lab2"></a><h2 class="section">A lightweight version of the Homotopy Type Theory library prelude.</h2>

</div>
<div class="code">
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden".<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Unicode.Utf8</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Program.Tactics</span> <span class="id" title="var">Setoid</span> <span class="id" title="var">Relations</span>.<br/>
</div>

<div class="doc">
Switches to constants in Type 
</div>
<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Equations.Type</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">All</span>.<br/>

<br/>
</div>

<div class="doc">
This imports the polymorphic identity and sigma types in Type and their associated notations. 
</div>
<div class="code">
<span class="id" title="keyword">Import</span> <span class="id" title="var">Id_Notations</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Sigma_Notations</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">equations_scope</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-deprecated-option".<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Universe</span> <span class="id" title="var">Polymorphism</span>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Primitive</span> <span class="id" title="var">Projections</span>.<br/>
</div>

<div class="doc">
We want our definitions to stay transparent. 
</div>
<div class="code">
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Transparent</span>.<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
</div>

<div class="doc">
Redefine a polymorphic identity function 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">id</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">A</span> := <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">CRelationClasses</span> <span class="id" title="var">CMorphisms</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">id_reflexive</span> <span class="id" title="var">A</span> : <span class="id" title="var">Reflexive</span> (@<span class="id" title="var">Id</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">exact</span> (@<span class="id" title="var">id_refl</span> <span class="id" title="var">A</span>). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">eq_symmetric</span> <span class="id" title="var">A</span> : <span class="id" title="var">Symmetric</span> (@<span class="id" title="var">Id</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">exact</span> (@<span class="id" title="var">id_sym</span> <span class="id" title="var">A</span>). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">eq_transitive</span> <span class="id" title="var">A</span> : <span class="id" title="var">Transitive</span> (@<span class="id" title="var">Id</span> <span class="id" title="var">A</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">exact</span> (@<span class="id" title="var">id_trans</span> <span class="id" title="var">A</span>). <span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Non-dependent cartesian products are just sigma types. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">fst</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>) : <span class="id" title="var">A</span> :=<br/>
<span class="id" title="var">fst</span> (<span class="id" title="var">a</span>, <span class="id" title="var">b</span>) := <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">snd</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>) : <span class="id" title="var">B</span> :=<br/>
<span class="id" title="var">snd</span> (<span class="id" title="var">a</span>, <span class="id" title="var">b</span>) := <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Sect</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">s</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">r</span> (<span class="id" title="var">s</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">y</span> :=<br/>
<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">id_refl</span> := <span class="id" title="var">id_refl</span>.<br/>

<br/>
</div>

<div class="doc">
We define <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#transport"><span class="id" title="definition">transport</span></a></span> with the arguments in the order we like. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">transport</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">u</span> : <span class="id" title="var">P</span> <span class="id" title="var">x</span>) : <span class="id" title="var">P</span> <span class="id" title="var">y</span> :=<br/>
<span class="id" title="var">transport</span> <span class="id" title="var">P</span> <span class="id" title="var">id_refl</span> <span class="id" title="var">u</span> := <span class="id" title="var">u</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;p # x" := (<span class="id" title="var">transport</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>) (<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 65, <span class="id" title="var">only</span> <span class="id" title="var">parsing</span>).<br/>

<br/>
</div>

<div class="doc">
We use <span class="inlinecode">1</span> to refer to the reflexivity proof. 
</div>
<div class="code">
<span class="id" title="keyword">Notation</span> &quot;1" := <span class="id" title="var">id_refl</span> : <span class="id" title="var">equations_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Notation for the inverse 
</div>
<div class="code">
#[<span class="id" title="var">warnings</span>="-notation-incompatible-prefix"]<br/>
<span class="id" title="var">Reserved</span> <span class="id" title="keyword">Notation</span> "p ^" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 1, <span class="id" title="var">format</span> "p '^'").<br/>
#[<span class="id" title="var">warnings</span>="-notation-incompatible-prefix"]<br/>
<span class="id" title="keyword">Notation</span> "p ^" := (<span class="id" title="var">id_sym</span> <span class="id" title="var">p</span>%<span class="id" title="var">equations</span>) : <span class="id" title="var">equations_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">apd</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">B</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">B</span> <span class="id" title="var">x</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">p</span> # <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">y</span> :=<br/>
<span class="id" title="var">apd</span> <span class="id" title="var">f</span> 1 := 1.<br/>

<br/>
</div>

<div class="doc">
<a id="lab3"></a><h3 class="section">Equivalence</h3>

<div class="paragraph"> </div>

 A typeclass that includes the data making <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#Adjointify.f"><span class="id" title="variable">f</span></a></span> into an adjoint equivalence
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">IsEquiv</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) := <span class="id" title="var">BuildIsEquiv</span> {<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv_inv</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">eisretr</span> : <span class="id" title="var">Sect</span> <span class="id" title="var">equiv_inv</span> <span class="id" title="var">f</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">eissect</span> : <span class="id" title="var">Sect</span> <span class="id" title="var">f</span> <span class="id" title="var">equiv_inv</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">eisadj</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">eisretr</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) = <span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">x</span>)<br/>
}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">eisretr</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> <span class="id" title="var">f</span>%<span class="id" title="var">_function_scope</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">eissect</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> <span class="id" title="var">f</span>%<span class="id" title="var">_function_scope</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">eisadj</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> <span class="id" title="var">f</span>%<span class="id" title="var">_function_scope</span> {<span class="id" title="var">_</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">IsEquiv</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> <span class="id" title="var">f</span>%<span class="id" title="var">_function_scope</span>.<br/>

<br/>
</div>

<div class="doc">
A record that includes all the data of an adjoint equivalence. 
</div>
<div class="code">
<span class="id" title="keyword">Record</span> <span class="id" title="var">Equiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> := <span class="id" title="var">BuildEquiv</span> {<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv_fun</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv_isequiv</span> : <span class="id" title="var">IsEquiv</span> <span class="id" title="var">equiv_fun</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Coercion</span> <span class="id" title="var">equiv_fun</span> : <span class="id" title="var">Equiv</span> &gt;-&gt; <span class="id" title="var">Funclass</span>.<br/>

<br/>
<span class="id" title="keyword">Global Existing Instance</span> <span class="id" title="var">equiv_isequiv</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">equiv_fun</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">equiv_isequiv</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Bind Scope</span> <span class="id" title="var">equiv_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Equiv</span>.<br/>

<br/>
<span class="id" title="keyword">Reserved Infix</span> &quot;&lt;~&gt;" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 85).<br/>
<span class="id" title="keyword">Notation</span> &quot;A &lt;~&gt; B" := (<span class="id" title="var">Equiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 85) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;f ^^-1" := (@<span class="id" title="var">equiv_inv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 3).<br/>

<br/>
</div>

<div class="doc">
<a id="lab4"></a><h3 class="section">Functional extensionality</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pointwise_paths</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">P</span>:<span class="id" title="var">A</span>→<span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>) <br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Unfold</span> <span class="id" title="var">pointwise_paths</span> : <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;f == g" := (<span class="id" title="var">pointwise_paths</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
</div>

<div class="doc">
This definition has slightly changed: the match on the Id is external
   to the function. 
</div>
<div class="code">
<span class="id" title="keyword">Equations</span> <span class="id" title="var">apD10</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">B</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} {<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">B</span> <span class="id" title="var">x</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">f</span> = <span class="id" title="var">g</span>) : <span class="id" title="var">f</span> == <span class="id" title="var">g</span> :=<br/>
<span class="id" title="var">apD10</span> 1 := <span class="id" title="keyword">fun</span> <span class="id" title="var">h</span> ⇒ 1.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Funext</span> :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">isequiv_apD10</span> :: <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>) <span class="id" title="var">f</span> <span class="id" title="var">g</span>, <span class="id" title="var">IsEquiv</span> (@<span class="id" title="var">apD10</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>) }.<br/>

<br/>
<span class="id" title="keyword">Axiom</span> <span class="id" title="var">funext</span> : <span class="id" title="var">Funext</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <span class="id" title="var">funext</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_forall</span> `{<span class="id" title="var">Funext</span>} {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">f</span> == <span class="id" title="var">g</span> → <span class="id" title="var">f</span> = <span class="id" title="var">g</span><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;(@<span class="id" title="var">apD10</span> <span class="id" title="var">A</span> <span class="id" title="var">P</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>)^^-1.<br/>

<br/>
</div>

<div class="doc">
<a id="lab5"></a><h3 class="section">Path spaces in sigma types and product types</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">path_sigma</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">u</span>.1 = <span class="id" title="var">v</span>.1) (<span class="id" title="var">q</span> : <span class="id" title="var">p</span> # <span class="id" title="var">u</span>.2 = <span class="id" title="var">v</span>.2) : <span class="id" title="var">u</span> = <span class="id" title="var">v</span> :=<br/>
<span class="id" title="var">path_sigma</span> (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) 1 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">path_prod_uncurried</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pq</span> : (<span class="id" title="var">z</span>.1 = <span class="id" title="var">z'</span>.1) × (<span class="id" title="var">z</span>.2 = <span class="id" title="var">z'</span>.2)): <span class="id" title="var">z</span> = <span class="id" title="var">z'</span> :=<br/>
<span class="id" title="var">path_prod_uncurried</span> (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) (1, 1) := 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_prod</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">z</span>.1 = <span class="id" title="var">z'</span>.1) (<span class="id" title="var">f</span> : <span class="id" title="var">z</span>.2 = <span class="id" title="var">z'</span>.2) : <span class="id" title="var">z</span> = <span class="id" title="var">z'</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">path_prod_uncurried</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">e</span>, <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">path_prod_eq</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">z</span>.1 = <span class="id" title="var">z'</span>.1) (<span class="id" title="var">f</span> : <span class="id" title="var">z</span>.2 = <span class="id" title="var">z'</span>.2) : <span class="id" title="var">z</span> = <span class="id" title="var">z'</span> :=<br/>
<span class="id" title="var">path_prod_eq</span> (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) 1 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">eta_path_prod</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">z</span> = <span class="id" title="var">z'</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">path_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">ap</span> <span class="id" title="var">pr1</span> <span class="id" title="var">p</span>) (<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span> ⇒ <span class="id" title="var">pr2</span> <span class="id" title="var">x</span>) <span class="id" title="var">p</span>) = <span class="id" title="var">p</span> :=<br/>
<span class="id" title="var">eta_path_prod</span> 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_prod'</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">x'</span> : <span class="id" title="var">A</span>} {<span class="id" title="var">y</span> <span class="id" title="var">y'</span> : <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;: (<span class="id" title="var">x</span> = <span class="id" title="var">x'</span>) → (<span class="id" title="var">y</span> = <span class="id" title="var">y'</span>) → ((<span class="id" title="var">x</span>,<span class="id" title="var">y</span>) = (<span class="id" title="var">x'</span>,<span class="id" title="var">y'</span>))<br/>
&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> ⇒ <span class="id" title="var">path_prod</span> (<span class="id" title="var">x</span>, <span class="id" title="var">y</span>) (<span class="id" title="var">x'</span>, <span class="id" title="var">y'</span>) <span class="id" title="var">p</span> <span class="id" title="var">q</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_fst_path_prod</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">z</span>.1 = <span class="id" title="var">z'</span>.1) (<span class="id" title="var">q</span> : <span class="id" title="var">z</span>.2 = <span class="id" title="var">z'</span>.2) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ap</span> <span class="id" title="var">fst</span> (<span class="id" title="var">path_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) = <span class="id" title="var">p</span> :=<br/>
<span class="id" title="var">ap_fst_path_prod</span> (<span class="id" title="var">z</span>:=(<span class="id" title="var">_</span>, <span class="id" title="var">_</span>)) (<span class="id" title="var">z'</span>:=(<span class="id" title="var">_</span>, <span class="id" title="var">_</span>)) 1 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_snd_path_prod</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">z</span>.1 = <span class="id" title="var">z'</span>.1) (<span class="id" title="var">q</span> : <span class="id" title="var">z</span>.2 = <span class="id" title="var">z'</span>.2) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ap</span> <span class="id" title="var">snd</span> (<span class="id" title="var">path_prod</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) = <span class="id" title="var">q</span> :=<br/>
<span class="id" title="var">ap_snd_path_prod</span> (<span class="id" title="var">z</span>:=(<span class="id" title="var">_</span>, <span class="id" title="var">_</span>)) (<span class="id" title="var">z'</span>:=(<span class="id" title="var">_</span>, <span class="id" title="var">_</span>)) 1 1 := 1.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">isequiv_path_prod</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">z</span> <span class="id" title="var">z'</span> : <span class="id" title="var">A</span> × <span class="id" title="var">B</span>}<br/>
: <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">path_prod_uncurried</span> <span class="id" title="var">z</span> <span class="id" title="var">z'</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">BuildIsEquiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> ⇒ (<span class="id" title="var">ap</span> <span class="id" title="var">fst</span> <span class="id" title="var">r</span>, <span class="id" title="var">ap</span> <span class="id" title="var">snd</span> <span class="id" title="var">r</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eta_path_prod</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>]. <span class="id" title="tactic">exact</span> (<span class="id" title="var">path_prod'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ap_fst_path_prod</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ap_snd_path_prod</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">z</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x</span> <span class="id" title="var">y</span>], <span class="id" title="var">z'</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">x'</span> <span class="id" title="var">y'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span>; <span class="id" title="tactic">apply</span> 1.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">path_sigma_uncurried</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} (<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="var">pq</span> : <span class="id" title="var">Σ</span> <span class="id" title="var">p</span>, <span class="id" title="var">p</span> # <span class="id" title="var">u</span>.2 = <span class="id" title="var">v</span>.2)<br/>
&nbsp;&nbsp;: <span class="id" title="var">u</span> = <span class="id" title="var">v</span> :=<br/>
<span class="id" title="var">path_sigma_uncurried</span> (<span class="id" title="var">u1</span>, <span class="id" title="var">u2</span>) (<span class="id" title="var">_</span>, <span class="id" title="var">_</span>) (1, 1) := 1.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr1_path</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} {<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">u</span> = <span class="id" title="var">v</span>)<br/>
: <span class="id" title="var">u</span>.1 = <span class="id" title="var">v</span>.1<br/>
&nbsp;&nbsp;:= <span class="id" title="var">ap</span> (@<span class="id" title="var">pr1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">p</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;p ..1" := (<span class="id" title="var">pr1_path</span> <span class="id" title="var">p</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 3).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pr2_path</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} {<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">u</span> = <span class="id" title="var">v</span>)<br/>
: <span class="id" title="var">p</span>..1 # <span class="id" title="var">u</span>.2 = <span class="id" title="var">v</span>.2.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> 1.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;p ..2" := (<span class="id" title="var">pr2_path</span> <span class="id" title="var">p</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 3).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eta_path_sigma_uncurried</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} {<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">u</span> = <span class="id" title="var">v</span>) : <span class="id" title="var">path_sigma_uncurried</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">p</span>..1, <span class="id" title="var">p</span>..2) = <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">apply</span> 1.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eta_path_sigma</span> <span class="id" title="var">A</span> `{<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} {<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">u</span> = <span class="id" title="var">v</span>)<br/>
: <span class="id" title="var">path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">p</span>..1) (<span class="id" title="var">p</span>..2) = <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">eta_path_sigma_uncurried</span> <span class="id" title="var">p</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_sigma_equiv</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> : <span class="id" title="var">sigma</span> <span class="id" title="var">P</span>):<br/>
&nbsp;&nbsp;<span class="id" title="var">IsEquiv</span> (<span class="id" title="var">path_sigma_uncurried</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">BuildIsEquiv</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">exact</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">r</span> ⇒ (<span class="id" title="var">r</span>..1, <span class="id" title="var">r</span>..2)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intro</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eta_path_sigma_uncurried</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span>, <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">u</span>, <span class="id" title="var">v</span>; <span class="id" title="tactic">intros</span> [<span class="id" title="var">p</span> <span class="id" title="var">q</span>]; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×. <span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> 1.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab6"></a><h3 class="section">Groupoid laws for equality</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">e'</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) : <span class="id" title="var">x</span> = <span class="id" title="var">z</span> :=<br/>
<span class="id" title="var">concat</span> 1 <span class="id" title="var">q</span> := <span class="id" title="var">q</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;p @ q" := (<span class="id" title="var">concat</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">concat2</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} {<span class="id" title="var">p</span> <span class="id" title="var">p'</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>} {<span class="id" title="var">q</span> <span class="id" title="var">q'</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">p</span> = <span class="id" title="var">p'</span>) (<span class="id" title="var">h'</span> : <span class="id" title="var">q</span> = <span class="id" title="var">q'</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">p</span> @ <span class="id" title="var">q</span> = <span class="id" title="var">p'</span> @ <span class="id" title="var">q'</span><br/>
:= <span class="id" title="keyword">match</span> <span class="id" title="var">h</span>, <span class="id" title="var">h'</span> <span class="id" title="keyword">with</span> 1, 1 ⇒ 1 <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;p @@ q" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20).<br/>
<span class="id" title="keyword">Notation</span> &quot;p @@ q" := (<span class="id" title="var">concat2</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)%<span class="id" title="var">equations</span> : <span class="id" title="var">equations_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">moveR_E</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> → <span class="id" title="var">B</span>) {<span class="id" title="var">H</span> : <span class="id" title="var">IsEquiv</span> <span class="id" title="var">f</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">f</span>^^-1 <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;:= <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> @ (@<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
One can use the shortcut notation <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">p</span></span> to give patterns for the explicit arguments
    without repeating the function name. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_1p</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;1 @ <span class="id" title="var">p</span> = <span class="id" title="var">p</span> :=<br/>
| 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_p1</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>}<br/>
&nbsp;(<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">p</span> @ 1  = <span class="id" title="var">p</span> :=<br/>
| 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_Vp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">p</span>^ @ <span class="id" title="var">p</span> = 1 := | 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_pV</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">p</span> @ <span class="id" title="var">p</span>^ = 1 := | 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_p_pp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> <span class="id" title="var">t</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">z</span> = <span class="id" title="var">t</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">p</span> @ (<span class="id" title="var">q</span> @ <span class="id" title="var">r</span>) = (<span class="id" title="var">p</span> @ <span class="id" title="var">q</span>) @ <span class="id" title="var">r</span> :=<br/>
<span class="id" title="var">concat_p_pp</span> 1 <span class="id" title="var">_</span> <span class="id" title="var">_</span> := 1.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Rewrite</span> @<span class="id" title="var">concat_p1</span> @<span class="id" title="var">concat_Vp</span> @<span class="id" title="var">concat_pV</span> : <span class="id" title="var">concat</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">Id_equiv</span> <span class="id" title="var">A</span> : <span class="id" title="var">Equivalence</span> (@<span class="id" title="var">Id</span> <span class="id" title="var">A</span>) := {}.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">concat_morphism</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">Proper</span> (<span class="id" title="var">Id</span> ==&gt; <span class="id" title="var">Id</span> ==&gt; <span class="id" title="var">Id</span>) (@<span class="id" title="var">concat</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">reduce</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">X0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">x0</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">trans_co_eq_inv_arrow_morphism@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span>} :<br/>
&nbsp;&nbsp;∀ (<span class="id" title="var">A</span> : <span class="id" title="var">Type@</span>{<span class="id" title="var">i</span>}) (<span class="id" title="var">R</span> : <span class="id" title="var">crelation@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span>} <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Transitive</span> <span class="id" title="var">R</span> → <span class="id" title="var">Proper@</span>{<span class="id" title="var">k</span> <span class="id" title="var">j</span>} (<span class="id" title="var">respectful@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>} <span class="id" title="var">R</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">respectful@</span>{<span class="id" title="var">i</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span> <span class="id" title="var">j</span>} <span class="id" title="var">Id</span> (@<span class="id" title="var">flip@</span>{<span class="id" title="var">k</span> <span class="id" title="var">k</span> <span class="id" title="var">k</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Type@</span>{<span class="id" title="var">j</span>} <span class="id" title="var">arrow</span>))) <span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">reduce</span>. <span class="id" title="tactic">transitivity</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">X1</span>. <span class="id" title="keyword">Defined</span>.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <span class="id" title="var">trans_co_eq_inv_arrow_morphism</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_pp_A1</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> = <span class="id" title="var">g</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">w</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">r</span> : <span class="id" title="var">w</span> = <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">r</span> @ <span class="id" title="var">p</span> <span class="id" title="var">x</span>) @ <span class="id" title="var">ap</span> <span class="id" title="var">g</span> <span class="id" title="var">q</span> = (<span class="id" title="var">r</span> @ <span class="id" title="var">q</span>) @ <span class="id" title="var">p</span> <span class="id" title="var">y</span> :=<br/>
<span class="id" title="var">concat_pp_A1</span> <span class="id" title="var">_</span> 1 1 := <span class="id" title="var">concat_p1</span> <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">whiskerL</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">q</span> <span class="id" title="var">r</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">q</span> = <span class="id" title="var">r</span>) : <span class="id" title="var">p</span> @ <span class="id" title="var">q</span> = <span class="id" title="var">p</span> @ <span class="id" title="var">r</span> :=<br/>
<span class="id" title="var">whiskerL</span> <span class="id" title="var">_</span> 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">whiskerR</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} {<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span> : <span class="id" title="var">p</span> = <span class="id" title="var">q</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) : <span class="id" title="var">p</span> @ <span class="id" title="var">r</span> = <span class="id" title="var">q</span> @ <span class="id" title="var">r</span> :=<br/>
<span class="id" title="var">whiskerR</span> 1 <span class="id" title="var">_</span> := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">moveL_M1</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">id_sym</span> <span class="id" title="var">q</span> @ <span class="id" title="var">p</span> = 1 → <span class="id" title="var">p</span> = <span class="id" title="var">q</span> :=<br/>
<span class="id" title="var">moveL_M1</span> <span class="id" title="var">_</span> 1 := <span class="id" title="keyword">fun</span> <span class="id" title="var">e</span> ⇒ <span class="id" title="var">e</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">inverse2</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} {<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">p</span> = <span class="id" title="var">q</span>)<br/>
: <span class="id" title="var">id_sym</span> <span class="id" title="var">p</span> = <span class="id" title="var">id_sym</span> <span class="id" title="var">q</span> := <span class="id" title="var">ap</span> (@<span class="id" title="var">id_sym</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">h</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap02</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">A</span>→<span class="id" title="var">B</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">A</span>} {<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">x</span>=<span class="id" title="var">y</span>} (<span class="id" title="var">r</span>:<span class="id" title="var">p</span>=<span class="id" title="var">q</span>) : <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> = <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span> :=<br/>
<span class="id" title="var">ap02</span> <span class="id" title="var">f</span> 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_p_pp</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) {<span class="id" title="var">w</span> : <span class="id" title="var">B</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">r</span> : <span class="id" title="var">w</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">r</span> @ (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">p</span> @ <span class="id" title="var">q</span>)) = (<span class="id" title="var">r</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) @ (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span>) :=<br/>
<span class="id" title="var">ap_p_pp</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span> := <span class="id" title="var">concat_p_pp</span> <span class="id" title="var">_</span> 1 <span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_compose</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> → <span class="id" title="var">C</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ap</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">p</span> = <span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) :=<br/>
<span class="id" title="var">ap_compose</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> 1 := 1.<br/>

<br/>
</div>

<div class="doc">
An example of the <span class="inlinecode"><span class="id" title="keyword">with</span></span> construct doing abstraction in the context and conclusion.
    Here <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> is abstracted first, then <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#Adjointify.g"><span class="id" title="variable">g</span></a></span> <span class="inlinecode"><span class="id" title="var">x</span></span>, resulting in a goal <span class="inlinecode"><span class="id" title="var">gx</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#Adjointify.A"><span class="id" title="variable">A</span></a>,</span> <span class="inlinecode"><span class="id" title="var">px</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">gx</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">x</span></span>.
 
</div>
<div class="code">
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_A1p</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">g</span> <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">ap</span> <span class="id" title="var">g</span> <span class="id" title="var">q</span>) @ (<span class="id" title="var">p</span> <span class="id" title="var">y</span>) = (<span class="id" title="var">p</span> <span class="id" title="var">x</span>) @ <span class="id" title="var">q</span> :=<br/>
<span class="id" title="var">concat_A1p</span> <span class="id" title="var">p</span> 1 <span class="id" title="keyword">with</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>, <span class="id" title="var">g</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;{ <span class="id" title="var">concat_A1p</span> <span class="id" title="var">p</span> (<span class="id" title="var">x</span>:=?(<span class="id" title="var">x</span>)) 1 1 <span class="id" title="var">x</span> := 1 }.<br/>

<br/>
</div>

<div class="doc">
Dummy example using functional elimination on a proof-relevant function using <span class="inlinecode"><span class="id" title="keyword">with</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">concat_A1p_lemma</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span>) (<span class="id" title="var">p</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">x</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">concat_A1p</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) = (<span class="id" title="var">concat_A1p</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">apply_funelim</span> (<span class="id" title="var">concat_A1p</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>). <span class="id" title="tactic">clear</span>; <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">elim</span> <span class="id" title="var">Heq0</span> <span class="id" title="keyword">using</span> <span class="id" title="var">Logic.Id_rect_r</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_pp</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">p</span> @ <span class="id" title="var">q</span>) = (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) @ (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span>) :=<br/>
<span class="id" title="var">ap_pp</span> <span class="id" title="var">_</span> 1 1 ⇒ 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_pp_V</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> @ <span class="id" title="var">q</span>) @ <span class="id" title="var">id_sym</span> <span class="id" title="var">q</span> = <span class="id" title="var">p</span> :=<br/>
<span class="id" title="var">concat_pp_V</span> 1 1 ⇒ 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_V</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">id_sym</span> <span class="id" title="var">p</span>) = <span class="id" title="var">id_sym</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span>) :=<br/>
<span class="id" title="var">ap_V</span> <span class="id" title="var">f</span> 1 ⇒ 1.<br/>

<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Rewrite</span> @<span class="id" title="var">ap_pp</span> @<span class="id" title="var">ap_V</span> : <span class="id" title="var">ap</span>.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Rewrite</span> @<span class="id" title="var">concat_pp_V</span> : <span class="id" title="var">concat</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_pA1</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> <span class="id" title="var">x</span>) @ (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span>) = <span class="id" title="var">q</span> @ (<span class="id" title="var">p</span> <span class="id" title="var">y</span>) :=<br/>
<span class="id" title="var">concat_pA1</span> <span class="id" title="var">p</span> 1 := <span class="id" title="var">concat_p1</span> (<span class="id" title="var">p</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_p_Vp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">z</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">p</span> @ (<span class="id" title="var">id_sym</span> <span class="id" title="var">p</span> @ <span class="id" title="var">q</span>) = <span class="id" title="var">q</span> :=<br/>
<span class="id" title="var">concat_p_Vp</span> 1 1 := 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">concat_pV_p</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">z</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="var">p</span> @ <span class="id" title="var">id_sym</span> <span class="id" title="var">q</span>) @ <span class="id" title="var">q</span> = <span class="id" title="var">p</span> :=<br/>
<span class="id" title="var">concat_pV_p</span> 1 1 := 1.<br/>
#[<span class="id" title="var">export</span>] <span class="id" title="keyword">Hint</span> <span class="id" title="keyword">Rewrite</span> @<span class="id" title="var">concat_pA1</span> @<span class="id" title="var">concat_p_Vp</span> @<span class="id" title="var">concat_pV_p</span> : <span class="id" title="var">concat</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">concat_pA1_p</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;{<span class="id" title="var">w</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">r</span> : <span class="id" title="var">w</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;: (<span class="id" title="var">r</span> @ <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span>) @ <span class="id" title="var">p</span> <span class="id" title="var">y</span> = (<span class="id" title="var">r</span> @ <span class="id" title="var">p</span> <span class="id" title="var">x</span>) @ <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">q</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;now&nbsp;simp&nbsp;concat.&nbsp;*)</span><br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">ap_p</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> <span class="id" title="var">q</span>: <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">p</span> = <span class="id" title="var">q</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> = <span class="id" title="var">ap</span> <span class="id" title="var">f</span> <span class="id" title="var">q</span> :=<br/>
<span class="id" title="var">ap_p</span> <span class="id" title="var">f</span> 1 := 1.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">ap_morphism</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">f</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">Proper</span> (@<span class="id" title="var">Id</span> (@<span class="id" title="var">Id</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) ==&gt; @<span class="id" title="var">Id</span> (@<span class="id" title="var">Id</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">y</span>))) (@<span class="id" title="var">ap</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">reduce</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">ap_p</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">reflexive_proper_proxy</span> :<br/>
&nbsp;&nbsp;∀ (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">R</span> : <span class="id" title="var">crelation</span> <span class="id" title="var">A</span>), <span class="id" title="var">Reflexive</span> <span class="id" title="var">R</span> → ∀ <span class="id" title="var">x</span> : <span class="id" title="var">A</span>, <span class="id" title="var">ProperProxy</span> <span class="id" title="var">R</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">reduce</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">X</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">isequiv_inverse</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">H</span>:<span class="id" title="var">IsEquiv</span> <span class="id" title="var">f</span>) : <span class="id" title="var">IsEquiv</span> (<span class="id" title="var">f</span>^^-1) | 1000.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">BuildIsEquiv</span> (@<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>) (@<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">concat_1p</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">concat_Vp</span>  (<span class="id" title="var">ap</span> <span class="id" title="var">f</span>^^-1 (<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">whiskerR</span> (<span class="id" title="var">inverse2</span> (<span class="id" title="var">ap02</span> <span class="id" title="var">f</span>^^-1 (<span class="id" title="var">eisadj</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>)))) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<span class="id" title="var">whiskerL</span> <span class="id" title="var">_</span> (<span class="id" title="var">id_sym</span> (<span class="id" title="var">concat_1p</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>))) @ <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">concat_Vp</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span>^^-1 (<span class="id" title="var">f</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">whiskerL</span> <span class="id" title="var">_</span> (<span class="id" title="var">concat_1p</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span>^^-1 (<span class="id" title="var">f</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>)))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">concat_pV</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span>^^-1 (<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_M1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Now&nbsp;we&nbsp;apply&nbsp;lots&nbsp;of&nbsp;naturality&nbsp;and&nbsp;cancel&nbsp;things.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">concat_pp_A1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ <span class="id" title="var">id_sym</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">ap_compose</span> <span class="id" title="var">f</span> <span class="id" title="var">f</span>^^-1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">ap_p_pp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span>^^-1 (<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>))))) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">ap_compose</span> <span class="id" title="var">f</span>^^-1 <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_A1p</span> (@<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_pp</span>, <span class="id" title="var">concat_p_pp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_pp_V</span> <span class="id" title="var">_</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span>^^-1 (<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> (<span class="id" title="var">f</span> (<span class="id" title="var">f</span>^^-1 <span class="id" title="var">b</span>))))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ap_V</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ap_pp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">concat_pA1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">id_sym</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> <span class="id" title="var">y</span>)) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_compose</span>, &lt;- (<span class="id" title="var">ap_compose</span> <span class="id" title="var">f</span>^^-1 <span class="id" title="var">f</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ap_p_pp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_A1p</span> (@<span class="id" title="var">eisretr</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_Vp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ap_compose</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_pA1_p</span> (@<span class="id" title="var">eissect</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pV_p</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_Vp</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">transport_inv</span> <span class="id" title="var">A</span> {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> :<span class="id" title="var">A</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">u</span>:<span class="id" title="var">P</span> <span class="id" title="var">x</span>) <span class="id" title="var">v</span>:<br/>
&nbsp;&nbsp;<span class="id" title="var">u</span> = <span class="id" title="var">e</span>^ # <span class="id" title="var">v</span> → <span class="id" title="var">e</span> # <span class="id" title="var">u</span> = <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">exact</span> <span class="id" title="var">id</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">moveR_M1</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;1 = <span class="id" title="var">p</span>^ @ <span class="id" title="var">q</span> → <span class="id" title="var">p</span> = <span class="id" title="var">q</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">exact</span> (<span class="id" title="var">h</span> @ (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">moveL_Vp</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> : <span class="id" title="var">x</span> = <span class="id" title="var">z</span>) (<span class="id" title="var">q</span> : <span class="id" title="var">y</span> = <span class="id" title="var">z</span>) (<span class="id" title="var">r</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">r</span> @ <span class="id" title="var">q</span> = <span class="id" title="var">p</span> → <span class="id" title="var">q</span> = <span class="id" title="var">r</span>^ @ <span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">exact</span> ((<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>)^ @ <span class="id" title="var">h</span> @ (<span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>)^).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab7"></a><h3 class="section">Contractibility</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Contr</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) := <span class="id" title="var">BuildContr</span> {<br/>
&nbsp;&nbsp;<span class="id" title="var">center</span> : <span class="id" title="var">A</span> ;<br/>
&nbsp;&nbsp;<span class="id" title="var">contr</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">center</span> = <span class="id" title="var">y</span>)<br/>
}.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">center</span> <span class="id" title="var">A</span> {<span class="id" title="var">Contr</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">contr_equiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) `{<span class="id" title="var">IsEquiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>} `{<span class="id" title="var">Contr</span> <span class="id" title="var">A</span>}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Contr</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<span class="id" title="var">f</span> (<span class="id" title="var">center</span> <span class="id" title="var">A</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">y</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">moveR_E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">contr</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">contr_forall</span> <span class="id" title="var">A</span> {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>} {<span class="id" title="var">H</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span>, <span class="id" title="var">Contr</span> (<span class="id" title="var">P</span> <span class="id" title="var">a</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Contr</span> (<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span>, <span class="id" title="var">P</span> <span class="id" title="var">a</span>) | 100.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ @<span class="id" title="var">center</span> <span class="id" title="var">_</span> (<span class="id" title="var">H</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_forall</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">contr</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">contr_unit</span> : <span class="id" title="var">Contr</span> <span class="id" title="var">unit</span> | 0 := {|<br/>
&nbsp;&nbsp;<span class="id" title="var">center</span> := <span class="id" title="var">tt</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">contr</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">t</span> : <span class="id" title="var">unit</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> <span class="id" title="var">tt</span> ⇒ 1 <span class="id" title="keyword">end</span> |}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path_contr</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">H</span>:<span class="id" title="var">Contr</span> <span class="id" title="var">A</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">x</span> = <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;:= <span class="id" title="var">concat</span> (<span class="id" title="var">id_sym</span> (@<span class="id" title="var">contr</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span>)) (@<span class="id" title="var">contr</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">path2_contr</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">H</span>:<span class="id" title="var">Contr</span> <span class="id" title="var">A</span>} {<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>} (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">p</span> = <span class="id" title="var">q</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">K</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">r</span> : <span class="id" title="var">x</span> = <span class="id" title="var">y</span>), <span class="id" title="var">r</span> = <span class="id" title="var">path_contr</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">symmetry</span>; <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">concat_Vp</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="tactic">transitivity</span> (<span class="id" title="var">y</span>:=<span class="id" title="var">path_contr</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="keyword">Instance</span> <span class="id" title="var">contr_paths_contr</span> <span class="id" title="var">A</span> {<span class="id" title="var">H</span>:<span class="id" title="var">Contr</span> <span class="id" title="var">A</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">Contr</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>) | 10000 := <span class="id" title="keyword">let</span> <span class="id" title="var">c</span> := {|<br/>
&nbsp;&nbsp;<span class="id" title="var">center</span> := <span class="id" title="var">concat</span> (<span class="id" title="var">id_sym</span> (<span class="id" title="var">contr</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">contr</span> <span class="id" title="var">y</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">contr</span> := <span class="id" title="var">path2_contr</span> (<span class="id" title="var">concat</span> (<span class="id" title="var">id_sym</span> (<span class="id" title="var">contr</span> <span class="id" title="var">x</span>)) (<span class="id" title="var">contr</span> <span class="id" title="var">y</span>))<br/>
|} <span class="id" title="tactic">in</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Global Program Instance</span> <span class="id" title="var">contr_prod</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> {<span class="id" title="var">CA</span> : <span class="id" title="var">Contr</span> <span class="id" title="var">A</span>} {<span class="id" title="var">CB</span> : <span class="id" title="var">Contr</span> <span class="id" title="var">B</span>} : <span class="id" title="var">Contr</span> (<span class="id" title="var">prod</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>. <span class="id" title="tactic">exact</span> (@<span class="id" title="var">center</span> <span class="id" title="var">_</span> <span class="id" title="var">CA</span>, @<span class="id" title="var">center</span> <span class="id" title="var">_</span> <span class="id" title="var">CB</span>). <span class="id" title="keyword">Defined</span>.<br/>
<span class="id" title="keyword">Next</span> <span class="id" title="keyword">Obligation</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">path_prod</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">contr</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">singletons_contr</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">Contr</span> (<span class="id" title="var">Σ</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">singletons_contr</span> <span class="id" title="var">x</span> := {| <span class="id" title="var">center</span> := (<span class="id" title="var">x</span>, 1); <span class="id" title="var">contr</span> := <span class="id" title="var">contr</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">where</span> <span class="id" title="var">contr</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">y</span> : (<span class="id" title="var">Σ</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>), (<span class="id" title="var">x</span>, 1) = <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">contr</span> (<span class="id" title="var">x</span>, 1) := 1.<br/>
#[<span class="id" title="var">local</span>] <span class="id" title="var">Existing</span> <span class="id" title="keyword">Instance</span> <span class="id" title="var">singletons_contr</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot; 'rew' H 'in' c " := (@<span class="id" title="var">Logic.Id_rew_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20).<br/>
<span class="id" title="keyword">Notation</span> &quot; 'rewd' H 'in' c " := (@<span class="id" title="var">Logic.Id_rect_r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20).<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h3 class="section">Singletons are contractible as a no-confusion principle</h3>


<div class="paragraph"> </div>

    The (heterogeneous) NoConfusion principle for equality, i.e.
    <span class="inlinecode"><span class="id" title="var">NoConfusiom</span></span> <span class="inlinecode">(<span class="id" title="var">Σ</span></span> <span class="inlinecode"><span class="id" title="var">y</span>,</span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">y</span>)</span> is equivalent to the proof that singletons
    are contractible, i.e that this type has a definitional equivalence with <span class="inlinecode"><a class="idref" href="http://rocq-prover.org/doc/V9.2+alpha/stdlib//Corelib.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a></span>.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">NoConfusion_singleton</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">Σ</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">unit</span>.<br/>

<br/>
<span class="id" title="keyword">Unset Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">noConfusion_singleton</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">Σ</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">NoConfusion_singleton</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> → <span class="id" title="var">p</span> = <span class="id" title="var">q</span> :=<br/>
&nbsp;<span class="id" title="var">noConfusion_singleton</span> <span class="id" title="var">x</span> (<span class="id" title="var">x</span>, 1) (<span class="id" title="var">x</span>, 1) <span class="id" title="var">tt</span> ⇒ 1.<br/>

<br/>
<span class="id" title="keyword">Equations</span> <span class="id" title="var">noConfusion_singleton_inv</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">Σ</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>) : <span class="id" title="var">p</span> = <span class="id" title="var">q</span> → <span class="id" title="var">NoConfusion_singleton</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> :=<br/>
&nbsp;<span class="id" title="var">noConfusion_singleton_inv</span> <span class="id" title="var">x</span> (<span class="id" title="var">x</span>, 1) ?((<span class="id" title="var">x</span>, 1)) 1 ⇒ <span class="id" title="var">tt</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">NoConfusionIdPackage_singleton</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">NoConfusionPackage</span> (<span class="id" title="var">Σ</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x</span> = <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">refine</span> {| <span class="id" title="var">NoConfusion</span> := @<span class="id" title="var">NoConfusion_singleton</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">noConfusion</span> := <span class="id" title="var">noConfusion_singleton</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">noConfusion_inv</span> := <span class="id" title="var">noConfusion_singleton_inv</span> <span class="id" title="var">x</span> |}.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span>. <span class="comment">(*&nbsp;also,&nbsp;this&nbsp;is&nbsp;an&nbsp;equality&nbsp;in&nbsp;the&nbsp;unit&nbsp;type...&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">dependent</span> <span class="id" title="var">elimination</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [(<span class="id" title="var">a</span>, 1)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">dependent</span> <span class="id" title="var">elimination</span> <span class="id" title="var">b</span> <span class="id" title="keyword">as</span> [(<span class="id" title="var">a</span>, 1)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span>. <span class="comment">(*&nbsp;&nbsp;apply&nbsp;path2_contr.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">dependent</span> <span class="id" title="var">elimination</span> <span class="id" title="var">e</span> <span class="id" title="keyword">as</span> [1].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">dependent</span> <span class="id" title="var">elimination</span> <span class="id" title="var">a</span> <span class="id" title="keyword">as</span> [(<span class="id" title="var">a</span>, 1)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">contr_sigma</span> <span class="id" title="var">A</span> {<span class="id" title="var">P</span> : <span class="id" title="var">A</span> → <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;{<span class="id" title="var">H</span> : <span class="id" title="var">Contr</span> <span class="id" title="var">A</span>} `{<span class="id" title="var">H0</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">a</span>, <span class="id" title="var">Contr</span> (<span class="id" title="var">P</span> <span class="id" title="var">a</span>)}<br/>
&nbsp;&nbsp;: <span class="id" title="var">Contr</span> (<span class="id" title="var">sigma</span> <span class="id" title="var">P</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<span class="id" title="var">center</span> <span class="id" title="var">A</span>, <span class="id" title="var">center</span> (<span class="id" title="var">P</span> (<span class="id" title="var">center</span> <span class="id" title="var">A</span>))).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">a</span> <span class="id" title="var">Ha</span>]. <span class="id" title="var">unshelve</span> <span class="id" title="tactic">refine</span> (<span class="id" title="var">path_sigma</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">transport_inv</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">H0</span> (<span class="id" title="var">center</span> <span class="id" title="var">A</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab9"></a><h3 class="section">Adjointification: producing an equivalence from an iso</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Adjointify</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">B</span> → <span class="id" title="var">A</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> (<span class="id" title="var">isretr</span> : <span class="id" title="var">Sect</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>) (<span class="id" title="var">issect</span> : <span class="id" title="var">Sect</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;is&nbsp;the&nbsp;modified&nbsp;<span class="inlinecode"><span class="id" title="var">eissect</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">issect'</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">issect</span> <span class="id" title="var">x</span>)^)  @  <span class="id" title="var">ap</span> <span class="id" title="var">g</span> (<span class="id" title="var">isretr</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>))  @  <span class="id" title="var">issect</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">is_adjoint'</span> (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">isretr</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) = <span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">issect'</span> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">issect'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveR_M1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_pp</span>, <span class="id" title="var">concat_p_pp</span>; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">ap_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_pA1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> ⇒ (<span class="id" title="var">isretr</span> <span class="id" title="var">b</span>)^) (<span class="id" title="var">ap</span> <span class="id" title="var">f</span> (<span class="id" title="var">issect</span> <span class="id" title="var">a</span>)^)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pp_p</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">ap_V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">concat_p_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">concat_p_pp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">moveL_Vp</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_p_pp</span>, &lt;- <span class="id" title="var">ap_compose</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">concat_pA1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> ⇒ (<span class="id" title="var">isretr</span> <span class="id" title="var">b</span>)^) (<span class="id" title="var">isretr</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">concat_pV</span>, <span class="id" title="var">concat_1p</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
We don't make this a typeclass instance, because we want to control when we are applying it. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">isequiv_adjointify</span> : <span class="id" title="var">IsEquiv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= @<span class="id" title="var">BuildIsEquiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">isretr</span> <span class="id" title="var">issect'</span> <span class="id" title="var">is_adjoint'</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equiv_adjointify</span> : <span class="id" title="var">A</span> &lt;~&gt; <span class="id" title="var">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= @<span class="id" title="var">BuildEquiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">isequiv_adjointify</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Adjointify</span>.<br/>

<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">isequiv_adjointify</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>)%<span class="id" title="var">_function_scope</span> <span class="id" title="var">isretr</span> <span class="id" title="var">issect</span>.<br/>
<span class="id" title="keyword">Arguments</span> <span class="id" title="var">equiv_adjointify</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>)%<span class="id" title="var">_function_scope</span> <span class="id" title="var">isretr</span> <span class="id" title="var">issect</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab10"></a><h3 class="section">Congruence preserves equivalence</h3>


<div class="paragraph"> </div>

 If <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#Adjointify.f"><span class="id" title="variable">f</span></a></span> is an equivalence, then so is <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#ap"><span class="id" title="definition">ap</span></a></span> <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.HoTT_light.html#Adjointify.f"><span class="id" title="variable">f</span></a></span>.  We are lazy and use <span class="inlinecode"><span class="id" title="var">adjointify</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">isequiv_ap</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>} <span class="id" title="var">f</span> `{<span class="id" title="var">IsEquiv</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;: <span class="id" title="var">IsEquiv</span> (@<span class="id" title="var">ap</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) | 1000<br/>
&nbsp;&nbsp;:= <span class="id" title="var">isequiv_adjointify</span> (<span class="id" title="var">ap</span> <span class="id" title="var">f</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> ⇒ (<span class="id" title="var">eissect</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>)^  @  <span class="id" title="var">ap</span> <span class="id" title="var">f</span>^^-1 <span class="id" title="var">q</span>  @  <span class="id" title="var">eissect</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">q</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ap_pp</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">whiskerR</span> (<span class="id" title="var">ap_pp</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ ((<span class="id" title="var">ap_V</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> @ <span class="id" title="var">inverse2</span> (<span class="id" title="var">eisadj</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>)^)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ (<span class="id" title="var">ap_compose</span> <span class="id" title="var">f</span>^^-1 <span class="id" title="var">f</span> <span class="id" title="var">_</span>)^<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@ (<span class="id" title="var">eisadj</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span>)^)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">concat_pA1_p</span> (<span class="id" title="var">eisretr</span> <span class="id" title="var">f</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">whiskerR</span> (<span class="id" title="var">concat_Vp</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">whiskerR</span> (<span class="id" title="var">whiskerL</span> <span class="id" title="var">_</span> (<span class="id" title="var">ap_compose</span> <span class="id" title="var">f</span> <span class="id" title="var">f</span>^^-1 <span class="id" title="var">_</span>)^) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">concat_pA1_p</span> (<span class="id" title="var">eissect</span> <span class="id" title="var">f</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">whiskerR</span> (<span class="id" title="var">concat_Vp</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;@ <span class="id" title="var">concat_1p</span> <span class="id" title="var">_</span>).<br/>

<br/>
</div>

<div class="doc">
The definition of homotopy fiber. 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">hfiber</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">B</span>) (<span class="id" title="var">y</span> : <span class="id" title="var">B</span>) := <span class="id" title="var">Σ</span> (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>), <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Global Arguments</span> <span class="id" title="var">hfiber</span> {<span class="id" title="var">A</span> <span class="id" title="var">B</span>}%<span class="id" title="var">_type_scope</span> <span class="id" title="var">f</span>%<span class="id" title="var">_function_scope</span> <span class="id" title="var">y</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://rocq-prover.org/">coqdoc</a>
</div>

</div>

</body>
</html>