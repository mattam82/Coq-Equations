<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Examples.working_with_vectors</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<div class="code">
</div>

<div class="doc">
<a id="lab1"></a><h1 class="section">Working with vectors</h1>


<div class="paragraph"> </div>

  We quickly develop a proof that vector reversal is involutive
  for indexed vectors. We also show the equivalence of the tail recursive 
  and naïve versions of vector reversal.

<div class="paragraph"> </div>

  To avoid transport hell, we reason on the total space <span class="inlinecode"><span class="id" title="var">Σ</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="http://rocq-prover.org/doc/V9.2+alpha/stdlib//Corelib.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,</span> <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.working_with_vectors.html#vector"><span class="id" title="inductive">vector</span></a></span> <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>
  and use (dependent) equational reasoning. This requires a few support definitions
  to move between transport equalities and total space equalities and to show 
  appropriately generalized congruence lemmas on the definitions, but once this setup
  is done, the proofs ressemble the usual reasoning on lists. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Arith</span> <span class="id" title="var">ssreflect</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="keyword">Equations</span>.<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Equations</span> <span class="id" title="keyword">Transparent</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">vectors</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <span class="id" title="var">T</span> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">vector</span> : <span class="id" title="var">nat</span> → <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">Vnil</span> : <span class="id" title="var">vector</span> 0<br/>
&nbsp;&nbsp;| <span class="id" title="var">Vcons</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">n</span>}, <span class="id" title="var">T</span> → <span class="id" title="var">vector</span> <span class="id" title="var">n</span> → <span class="id" title="var">vector</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>

<br/>
</div>

<div class="doc">
Let's define some more notation 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Local Notation</span> &quot;[]" := <span class="id" title="var">Vnil</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Notation</span> &quot;x :: y" := (@<span class="id" title="var">Vcons</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Declare Scope</span> <span class="id" title="var">vec_scope</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">vec_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">vec</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Bind Scope</span> <span class="id" title="var">vec_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">vector</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">vec_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Reserved Notation</span> &quot;x ++ y" (<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Usual&nbsp;concatenation&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span> <span class="id" title="var">app</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>} (<span class="id" title="var">v1</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">v2</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) : <span class="id" title="var">vector</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) :=<br/>
&nbsp;&nbsp;{ [] ++ <span class="id" title="var">v2</span> := <span class="id" title="var">v2</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> :: <span class="id" title="var">xs</span>) ++ <span class="id" title="var">v2</span> := <span class="id" title="var">x</span> :: <span class="id" title="var">xs</span> ++ <span class="id" title="var">v2</span> }<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> &quot;x ++ y" := (<span class="id" title="var">app</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) : <span class="id" title="var">vec_scope</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;uses&nbsp;(_,&nbsp;_)&nbsp;to&nbsp;denote&nbsp;the&nbsp;sigma&nbsp;type&nbsp;pairing.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Sigma_Notations</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">EqNotations</span>.<br/>

<br/>
</div>

<div class="doc">
Essential simplification lemmas when working in the "total" space <span class="inlinecode"><span class="id" title="var">Σ</span></span> <span class="inlinecode"><span class="id" title="var">n</span>,</span> <span class="inlinecode"><a class="idref" href="http://github.com/mattam82/Coq-Equations/tree/main/Equations.Examples.working_with_vectors.html#vector"><span class="id" title="inductive">vector</span></a></span> <span class="inlinecode"><span class="id" title="var">n</span></span> 
</div>
<div class="code">
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;uses&nbsp;(provable)&nbsp;UIP&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Equations</span> <span class="id" title="var">With</span> <span class="id" title="var">UIP</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_cons</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">v'</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) <span class="id" title="var">x</span> : (<span class="id" title="var">n</span>, <span class="id" title="var">v</span>) = (<span class="id" title="var">m</span>, <span class="id" title="var">v'</span>) → (<span class="id" title="var">S</span> <span class="id" title="var">n</span>, <span class="id" title="var">x</span> :: <span class="id" title="var">v</span>) = (<span class="id" title="var">S</span> <span class="id" title="var">m</span>, <span class="id" title="var">x</span> :: <span class="id" title="var">v'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [=]; <span class="id" title="tactic">subst</span>. <span class="id" title="var">depelim</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Working&nbsp;in&nbsp;the&nbsp;total&nbsp;space&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;transporting&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_rew</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">n</span> = <span class="id" title="var">m</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">v'</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) : (<span class="id" title="var">n</span>, <span class="id" title="var">v</span>) = (<span class="id" title="var">m</span>, <span class="id" title="var">v'</span>) ↔ <span class="id" title="var">rew</span> [<span class="id" title="var">vector</span>] <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span> = <span class="id" title="var">v'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span> ⇒ <span class="id" title="var">h</span>; <span class="id" title="var">noconf</span> <span class="id" title="var">h</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">to_total</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> <span class="id" title="var">v'</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : <span class="id" title="var">v</span> = <span class="id" title="var">v'</span> ↔ (<span class="id" title="var">n</span>, <span class="id" title="var">v</span>) = (<span class="id" title="var">n</span>, <span class="id" title="var">v'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">eq_rew</span> <span class="id" title="var">eq_refl</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;One&nbsp;can&nbsp;make&nbsp;toplevel&nbsp;transports&nbsp;disappear!&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">simpl_rew</span> {<span class="id" title="var">n</span> <span class="id" title="var">n'</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">n</span> = <span class="id" title="var">n'</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : (<span class="id" title="var">n'</span>, <span class="id" title="var">rew</span> [<span class="id" title="var">vector</span>] <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>) = (<span class="id" title="var">n</span>, <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>; <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now the usual theory of append 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">app_assoc</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">vector</span> <span class="id" title="var">k</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">_</span>, (<span class="id" title="var">v</span> ++ <span class="id" title="var">w</span>) ++ <span class="id" title="var">x</span>) = (<span class="id" title="var">_</span>, <span class="id" title="var">v</span> ++ (<span class="id" title="var">w</span> ++ <span class="id" title="var">x</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">funelim</span> (<span class="id" title="var">app</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>); <span class="id" title="var">cbn</span>; <span class="id" title="var">simp</span> <span class="id" title="var">app</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_cons</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">app_nil_r</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v1</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : (<span class="id" title="var">_</span>, <span class="id" title="var">v1</span> ++ []) = (<span class="id" title="var">_</span>, <span class="id" title="var">v1</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v1</span>; <span class="id" title="var">simp</span> <span class="id" title="var">app</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_cons</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Vrev&nbsp;using&nbsp;append&nbsp;or&nbsp;tail&nbsp;recursive&nbsp;version.&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span> <span class="id" title="var">vrev</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : <span class="id" title="var">vector</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [] ⇒ []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Vcons</span> (<span class="id" title="var">n</span>:=<span class="id" title="var">n</span>) <span class="id" title="var">x</span> <span class="id" title="var">xs</span> ⇒ <span class="id" title="var">rew</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="var">n</span> <span class="id" title="tactic">in</span> <span class="id" title="var">app</span> (<span class="id" title="var">vrev</span> <span class="id" title="var">xs</span>) (<span class="id" title="var">x</span> :: []).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;irrelevant&nbsp;obligations&nbsp;are&nbsp;filled&nbsp;by&nbsp;the&nbsp;default&nbsp;Program&nbsp;tactic&nbsp;here.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Equations</span> <span class="id" title="var">vrev_acc</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">acc</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>): <span class="id" title="var">vector</span> (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [], <span class="id" title="var">acc</span> ⇒ <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">x</span> :: <span class="id" title="var">xs</span>, <span class="id" title="var">acc</span> ⇒ <span class="id" title="var">rew</span> <span class="id" title="var">_</span> <span class="id" title="tactic">in</span> <span class="id" title="var">vrev_acc</span> <span class="id" title="var">xs</span> (<span class="id" title="var">x</span> :: <span class="id" title="var">acc</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Getting&nbsp;back&nbsp;the&nbsp;"natural"&nbsp;index&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">vrev_tail</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : <span class="id" title="var">vector</span> <span class="id" title="var">n</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rew</span> [<span class="id" title="var">vector</span>] (<span class="id" title="var">Nat.add_0_r</span> <span class="id" title="var">n</span>) <span class="id" title="tactic">in</span> (<span class="id" title="var">vrev_acc</span> <span class="id" title="var">v</span> <span class="id" title="var">Vnil</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;These&nbsp;simplification&nbsp;lemmas&nbsp;along&nbsp;with&nbsp;the&nbsp;congruence&nbsp;lemma&nbsp;below&nbsp;could&nbsp;be&nbsp;generically&nbsp;derived.&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;They&nbsp;essentially&nbsp;say&nbsp;that&nbsp;index&nbsp;information&nbsp;can&nbsp;be&nbsp;moved&nbsp;between&nbsp;the&nbsp;input&nbsp;and&nbsp;output&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;correspond&nbsp;to&nbsp;lemmas&nbsp;on&nbsp;lists&nbsp;like:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;length&nbsp;(append&nbsp;v&nbsp;w)&nbsp;=&nbsp;length&nbsp;v&nbsp;+&nbsp;length&nbsp;w.<br/>
&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">app_rew_l</span> {<span class="id" title="var">n</span> <span class="id" title="var">n'</span> <span class="id" title="var">m</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">n</span> = <span class="id" title="var">n'</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n'</span> + <span class="id" title="var">m</span>, (<span class="id" title="var">rew</span> [<span class="id" title="var">vector</span>] <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>) ++ <span class="id" title="var">w</span>) = (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>, <span class="id" title="var">v</span> ++ <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">app_rew_r</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">m'</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">m</span> = <span class="id" title="var">m'</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span> + <span class="id" title="var">m'</span>, <span class="id" title="var">v</span> ++ (<span class="id" title="var">rew</span> [<span class="id" title="var">vector</span>] <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">w</span>)) = (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>, <span class="id" title="var">v</span> ++ <span class="id" title="var">w</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vrev_rew</span> {<span class="id" title="var">n</span> <span class="id" title="var">n'</span>} (<span class="id" title="var">e</span> : <span class="id" title="var">n</span> = <span class="id" title="var">n'</span>) (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n'</span>, <span class="id" title="var">vrev</span> (<span class="id" title="var">rew</span> [<span class="id" title="var">vector</span>] <span class="id" title="var">e</span> <span class="id" title="tactic">in</span> <span class="id" title="var">v</span>)) = (<span class="id" title="var">n</span>, <span class="id" title="var">vrev</span> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;uses&nbsp;provable&nbsp;UIP&nbsp;as&nbsp;well&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">congr_append</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) (<span class="id" title="var">v'</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n'</span>) (<span class="id" title="var">w'</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m'</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span>, <span class="id" title="var">v</span>) = (<span class="id" title="var">n'</span>, <span class="id" title="var">v'</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">m</span>, <span class="id" title="var">w</span>) = (<span class="id" title="var">m'</span>, <span class="id" title="var">w'</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span> + <span class="id" title="var">m</span>, <span class="id" title="var">v</span> ++ <span class="id" title="var">w</span>) = (<span class="id" title="var">n'</span> + <span class="id" title="var">m'</span>, <span class="id" title="var">v'</span> ++ <span class="id" title="var">w'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>⇒ [=] <span class="id" title="var">e</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span> ⇒ <span class="id" title="var">h</span>; <span class="id" title="var">noconf</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">move</span>⇒ [=] <span class="id" title="var">e</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">e</span> ⇒ <span class="id" title="var">h</span>; <span class="id" title="var">noconf</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;tail&nbsp;rec&nbsp;version&nbsp;and&nbsp;its&nbsp;relation&nbsp;to&nbsp;append&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vrev_acc_spec</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) : (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>, <span class="id" title="var">vrev_acc</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>) = (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>, <span class="id" title="var">vrev</span> <span class="id" title="var">v</span> ++ <span class="id" title="var">w</span>) :&gt; <span class="id" title="var">Σ</span> <span class="id" title="var">n</span>, <span class="id" title="var">vector</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span> <span class="id" title="tactic">in</span> <span class="id" title="var">m</span>, <span class="id" title="var">w</span> |- *; <span class="id" title="var">cbn</span> ⇒ //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simp</span> <span class="id" title="var">vrev</span> <span class="id" title="var">vrev_acc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">simpl_rew</span> (<span class="id" title="var">app_rew_l</span> (<span class="id" title="var">n'</span> := <span class="id" title="var">S</span> <span class="id" title="var">n</span>)) <span class="id" title="var">IHv</span> <span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vrev_vrev_tail</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : <span class="id" title="var">vrev_tail</span> <span class="id" title="var">v</span> = <span class="id" title="var">vrev</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<span class="id" title="var">vrev_tail</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">eq_rew</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">vrev_acc_spec</span> <span class="id" title="var">app_nil_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">From</span> <span class="id" title="var">Stdlib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lia</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vrev_app</span> {<span class="id" title="var">n</span> <span class="id" title="var">m</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) (<span class="id" title="var">w</span> : <span class="id" title="var">vector</span> <span class="id" title="var">m</span>) : (<span class="id" title="var">n</span> + <span class="id" title="var">m</span>, <span class="id" title="var">vrev</span> (<span class="id" title="var">v</span> ++ <span class="id" title="var">w</span>)) = (<span class="id" title="var">m</span> + <span class="id" title="var">n</span>, <span class="id" title="var">vrev</span> <span class="id" title="var">w</span> ++ <span class="id" title="var">vrev</span> <span class="id" title="var">v</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>; <span class="id" title="var">cbn</span>; <span class="id" title="var">simp</span> <span class="id" title="var">vrev</span> <span class="id" title="var">app</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_nil_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">simpl_rew</span> <span class="id" title="var">app_rew_r</span> -<span class="id" title="var">app_assoc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">congr_append</span> ⇒ //.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vrev_acc_invol</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : <span class="id" title="var">vrev</span> (<span class="id" title="var">vrev</span> <span class="id" title="var">v</span>) = <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">v</span>; <span class="id" title="var">simp</span> <span class="id" title="var">vrev</span> ⇒ //=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">to_total</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">vrev_rew</span> <span class="id" title="var">vrev_app</span> <span class="id" title="var">IHv</span> <span class="id" title="var">app_rew_l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">vrev_tail_invol</span> {<span class="id" title="var">n</span>} (<span class="id" title="var">v</span> : <span class="id" title="var">vector</span> <span class="id" title="var">n</span>) : <span class="id" title="var">vrev_tail</span> (<span class="id" title="var">vrev_tail</span> <span class="id" title="var">v</span>) = <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> !<span class="id" title="var">vrev_vrev_tail</span> <span class="id" title="var">vrev_acc_invol</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Print</span> <span class="id" title="keyword">Assumptions</span> <span class="id" title="var">vrev_tail_invol</span>. <span class="comment">(*&nbsp;No&nbsp;axioms&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">vectors</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://rocq-prover.org/">coqdoc</a>
</div>

</div>

</body>
</html>